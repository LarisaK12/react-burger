{"version":3,"sources":["components/modal-overlay/modal-overlay.module.css","components/burger-element/burger-element.module.css","components/submit-order/submit-order.module.css","components/order-details/order-details.module.css","components/burger-ingredients/burger-ingredients.module.css","components/burger-ingredients-tab/burger-ingredients-tab.module.css","components/profile-orders-data/profile-orders-data.module.css","pages/profile.module.css","pages/login.module.css","utils/hooks.ts","utils/burger-constants.tsx","utils/utils.tsx","services/actions/profile.tsx","services/actions/ingredients.tsx","components/protected-route/protected-route.tsx","images/close.svg","components/modal-overlay/modal-overlay.tsx","components/modal/modal.tsx","services/actions/burger-constructor.tsx","components/burger-element/burger-element.tsx","components/submit-order/submit-order.tsx","images/done.gif","components/order-details/order-details.tsx","services/actions/order-details.tsx","services/actions/error.tsx","components/burger-constructor/burger-constructor.tsx","components/burger-ingredient-card/burger-ingredient-card.tsx","services/actions/tab.tsx","components/burger-ingredients-tab/burger-ingredients-tab.tsx","components/burger-ingredients/burger-ingredients.tsx","pages/constructor.tsx","services/actions/login.tsx","components/awaiter/awaiter.tsx","pages/login.tsx","pages/page404.tsx","pages/register.tsx","pages/forgot-password.tsx","pages/reset-password.tsx","components/profile-data/profile-data.tsx","components/orders-info/ingredient-row/ingredient-row.tsx","components/orders-info/order-card/order-card.tsx","components/profile-orders-data/profile-orders-data.tsx","services/actions/ws.tsx","pages/profile.tsx","components/ingredient-details/ingredient-details.tsx","services/actions/ingredient-details.tsx","pages/ingredient-details.tsx","components/orders-info/order-ingredients-list/order-ingredients-list.tsx","components/orders-info/order-details-extended/order-details-extended.tsx","pages/order-details.tsx","components/orders-info/orders-ready/orders-ready.tsx","components/orders-info/order-lists/order-lists.tsx","pages/feed.tsx","components/app-header/app-header-item.tsx","components/app-header/app-header.tsx","components/modal-switch/modal-switch.tsx","components/app/app.tsx","reportWebVitals.ts","services/reducers/burger-constructor.tsx","services/reducers/ingredients.tsx","services/reducers/error.tsx","services/reducers/order-details.tsx","services/reducers/ingredient-details.tsx","services/reducers/tab.tsx","services/reducers/profile.tsx","services/reducers/login.tsx","services/reducers/ws.tsx","services/reducers/index.tsx","services/store.tsx","services/middleware/socketMiddleware.ts","index.tsx","components/profile-data/profile-data.module.css","components/ingredient-details/ingredient-details.module.css","components/app-header/app-header.module.css","components/burger-ingredient-card/burger-ingredient-card.module.css","pages/reset-password.module.css","pages/forgot-password.module.css","components/orders-info/ingredient-row/ingredient-row.module.css","components/orders-info/order-card/order-card.module.css","components/orders-info/order-details-extended/order-details-extended.module.css","components/orders-info/order-ingredients-list/order-ingredients-list.module.css","pages/feed.module.css","pages/constructor.module.css","pages/page404.module.css","pages/order-details.module.css","components/orders-info/order-lists/order-lists.module.css","components/modal/modal.module.css","components/burger-constructor/burger-constructor.module.css","components/awaiter/awaiter.module.css","pages/ingredient-details.module.css"],"names":["module","exports","useDispatch","dispatchHook","useSelector","selectorHook","GET_ORDER_ID_URL","API_URL","WS_URL","USER_URL","checkResponse","res","ok","json","Promise","reject","status","fetchData","url","method","data","fetch","headers","body","then","fetchWithToken","getToken","Authorization","getCookie","fetchWithRefresh","refreshToken","catch","e","JSON","stringify","token","resolve","success","aToken","accessToken","split","setCookie","expires","message","deleteCookie","name","matches","document","cookie","match","RegExp","replace","decodeURIComponent","undefined","value","props","exp","d","Date","setTime","getTime","toUTCString","updatedCookie","encodeURIComponent","dateToString","dtime","dt","day","getFullYear","getMonth","getDay","toLocaleTimeString","toString","GET_USER_REQUEST","GET_USER_SUCCESS","GET_USER_FAILED","SET_USER_REQUEST","SET_USER_SUCCESS","SET_USER_FAILED","REG_USER_REQUEST","REG_USER_SUCCESS","REG_USER_FAILED","FORGOT_PASS_REQUEST","FORGOT_PASS_SUCCESS","FORGOT_PASS_FAILED","RESET_PASS_REQUEST","RESET_PASS_SUCCESS","RESET_PASS_FAILED","resetPassResult","isSuccess","type","forgotPasswordResult","setUserResult","user","getUserResult","regUserResult","register","dispatch","getUser","indexOf","setUser","forgotPassword","resetPassword","GET_INGREDIENTS_REQUEST","GET_INGREDIENTS_SUCCESS","GET_INGREDIENTS_FAILED","getIngredientsFailed","getIngredients","ingredients","ProtectedRoute","store","profile","render","children","to","pathname","ModalOverlay","id","className","styles","background","onClick","onClose","Modal","header","modalRoot","getElementById","onKeydown","key","React","useEffect","addEventListener","removeEventListener","ReactDOM","createPortal","modal","stopPropagation","src","CloseImg","alt","ADD_INGREDIENT","REMOVE_INGREDIENT","MOVE_INGREDIENT","CLEAR_INGREDIENTS","BurgerElement","ref","useRef","useDrop","accept","hover","item","monitor","current","dragIndex","index","hoverIndex","hoverBoundingRect","getBoundingClientRect","hoverMiddleY","bottom","top","clientOffset","getClientOffset","hoverClientY","y","oldPlace","newPlace","dropRef","useDrag","_id","dragRef","element","isLocked","handleClose","place","memo","SubmitOrder","price","constructor","onSubmit","submit","size","OrderDetails","orderId","order","flexcol","DoneGif","SUBMIT_ORDER_REQUEST","SUBMIT_ORDER_SUCCESS","SUBMIT_ORDER_FAILED","GET_ORDER_REQUEST","GET_ORDER_SUCCESS","GET_ORDER_FAILED","RESET_ORDER","submitOrderResult","getOrderResult","submitOrder","number","getOrder","orders","length","SET_ERROR","CLEAR_ERROR","setError","errorText","error","clearError","BurgerConstructor","history","useHistory","burger","submitOrderFailed","useMemo","filter","b","middleIngredients","ingr","drop","ingredient","dropTarget","Boolean","scrollable","map","Fragment","preventDefault","i","BurgerIngredientCard","counter","collect","isDrag","isDragging","preview","location","useLocation","state","link","DragPreviewImage","connect","image","ingredient_card","count","img","price_div","item_center","SET_TAB","SET_RATIO","BurgerIngredientsTab","useInView","threshold","inView","entry","filteredIngredients","ratio","intersectionRatio","title","ingretients_tab","BurgerIngredients","ingredientsRequest","ingredientsFailed","tab","tabs","scrollIntoView","setActiveTab","style","display","active","ConstructorPage","dispatcher","main","DndProvider","backend","HTML5Backend","section","LOGIN_REQUEST","LOGIN_SUCCESS","LOGIN_FAILED","LOGOUT_REQUEST","LOGOUT_SUCCESS","LOGOUT_FAILED","loginFailed","logoutSucccess","logoutFailed","login","logout","Awaiter","inner","LoginPage","useState","emailValue","setEmailValue","passValue","setPassValue","loginRequestFailed","profileRequest","from","email","password","onChange","target","Code404Page","RegisterPage","nameValue","setNameValue","regRequestFailed","regRequest","placeholder","ForgotPasswordPage","profileRequestFailed","passwordResetRequired","loggedIn","ResetPasswordPage","setValue","passwordReseted","ProfileData","setProfileRequest","setProfileRequestFailed","icon","IngredientRow","selectedIngreients","si","forEach","find","push","reduce","s","img_container","padding","margin","OrderCard","card","row","createdAt","green","ProfileOrdersData","ws","WS_CONNECTION_START","WS_CONNECTION_SUCCESS","WS_CONNECTION_ERROR","WS_CONNECTION_CLOSED","WS_GET_MESSAGE","WS_CLOSE_CONNECTION","startConnection","wsUrl","payload","closeConnection","ProfilePage","divLink","alink","IngredientDetails","details_card","image_large","details","details_part","calories","proteins","fat","carbohydrates","SET_CURRENT_INGREDIENT","CLEAR_CURRENT_INGREDIENT","IngredientDetailsPage","useParams","currentIngredient","OrderIngredientsList","some","c","findIndex","cnt","container","OrderDetailsExtended","horizontal","OrderDetailsPage","getOrderRequest","getOrderFailed","Number","window","OrdersReady","quantity","OrderLists","readyOrders","arr","chunkSize","R","slice","splitArray","ready","number_container","index2","whiteSpace","waiting","FeedPage","total","totalToday","ord","waitingOrders","HeaderItem","nav","text","AppHeader","currentPage","setCurrentPage","setConstructor","useCallback","setOrders","setProfile","logo","ModalSwitch","closeModal","goBack","path","exact","App","forgotPassRequest","resetPassRequest","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","initialState","InitialState","submitOrderRequest","resetPassRequestFailed","forgotPassRequestFailed","loginRequest","logoutRequest","logoutRequestFailed","isConnected","rootReducer","combineReducers","action","hasBun","burgerIngredients","splice","thumbnail","placeOfBottomBun","newburger","newprice","anewburger","deleted","t","newTabs","newCurrent","prev","next","timeStamp","enhancer","composeWithDevTools","applyMiddleware","thunk","socket","WebSocket","close","onopen","event","onerror","onmessage","msg","answer","parse","getMessage","onclose","createStore","StrictMode"],"mappings":"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","file":"static/js/main.dae7a9dc.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"background\":\"modal-overlay_background__2v-BB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"element\":\"burger-element_element__2_28Y\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"submit\":\"submit-order_submit__1muw6\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"flexcol\":\"order-details_flexcol__2bO_L\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mainDiv\":\"burger-ingredients_mainDiv__1neh3\",\"ingredients\":\"burger-ingredients_ingredients__3J_i0\",\"item_center\":\"burger-ingredients_item_center__kK8By\",\"alink\":\"burger-ingredients_alink__31H-F\",\"avisited\":\"burger-ingredients_avisited__2i3Df\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingretients_tab\":\"burger-ingredients-tab_ingretients_tab__21fm4\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"scrollable\":\"profile-orders-data_scrollable__3YFOL\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"profile_main__6FTel\",\"section\":\"profile_section__3dYQV\",\"divLink\":\"profile_divLink__SJzUg\",\"alink\":\"profile_alink__27ZpJ\",\"link\":\"profile_link__wGb0z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"login_main__19egb\",\"inner\":\"login_inner__2ySqU\",\"item\":\"login_item__lL2u-\"};","import {\r\n    TypedUseSelectorHook,\r\n    useDispatch as dispatchHook,\r\n    useSelector as selectorHook\r\n  } from 'react-redux';\r\n  import { AppDispatch, RootState, AppThunk } from './types';\r\n  \r\n  export const useDispatch = () => dispatchHook<AppDispatch | AppThunk>();\r\n  export const useSelector: TypedUseSelectorHook<RootState> = selectorHook;","const INGREDIENTS_URL = \"/ingredients\";\r\nconst GET_ORDER_ID_URL = \"/orders\";\r\nconst API_URL = \"https://norma.nomoreparties.space/api\";\r\nconst WS_URL = \"wss://norma.nomoreparties.space\";\r\nconst LOGIN_URL = \"/auth/login\";\r\nconst REGISTER_URL = \"/auth/register \";\r\nconst LOGOUT_URL = \"/auth/logout\";\r\nconst TOKEN_URL = \"/auth/token\";\r\nconst USER_URL = \"/auth/user\";\r\nconst FORGOT_PASSWORD_URL = \"/password-reset\";\r\nconst RESET_PASSWORD_URL = \"/password-reset/reset\";\r\nconst ORDERS_ALL_URL = \"/orders/all\";\r\nconst USER_ORDERS_URL = \"/orders\";\r\nexport {\r\n  INGREDIENTS_URL,\r\n  GET_ORDER_ID_URL,\r\n  API_URL,\r\n  LOGIN_URL,\r\n  LOGOUT_URL,\r\n  REGISTER_URL,\r\n  TOKEN_URL,\r\n  USER_URL,\r\n  RESET_PASSWORD_URL,\r\n  FORGOT_PASSWORD_URL,\r\n  ORDERS_ALL_URL,\r\n  USER_ORDERS_URL,\r\n  WS_URL,\r\n};\r\n","import { API_URL, TOKEN_URL } from \"./burger-constants\";\r\nimport { TCookieProps } from \"./types\";\r\nexport const checkResponse = (res:Response) => {\r\n  if (res.ok) {\r\n    return res.json();\r\n  }\r\n  return Promise.reject(` ${res.status}: ${res.json()}`);\r\n};\r\nexport const fetchData = (url:string, method:string, data?:string) => {\r\n  return fetch(url, {\r\n    method: method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json;charset=utf-8\",\r\n    },\r\n    body: data,\r\n  }).then(checkResponse);\r\n};\r\nexport const fetchWithToken = (url:string, method:string, data?:string) => {\r\n return  getToken().then((res)=>{\r\n  return fetch(url, {\r\n    method: method,\r\n    headers: {\r\n      \"Content-Type\": \"application/json;charset=utf-8\",\r\n      Authorization: \"Bearer \" + getCookie(\"accessToken\"),\r\n    },\r\n    body: data,\r\n  }).then(checkResponse)\r\n})\r\n\r\n    \r\n};\r\nexport const fetchWithRefresh = (url:string, method:string, data?:string) => {\r\n  return refreshToken().then((res) => {\r\n    return fetchWithToken(url, method, data);\r\n  })\r\n  .catch(e=>{\r\n    return Promise.reject(e);\r\n  });\r\n    \r\n};\r\n//   access \r\nexport const refreshToken = () => {\r\n  if (!getCookie(\"refreshToken\")) {\r\n    return Promise.reject(`:  `);}\r\n  else\r\n    return fetch(`${API_URL}${TOKEN_URL}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json;charset=utf-8\",\r\n      },\r\n      body: JSON.stringify({ token: getCookie(\"refreshToken\") }),\r\n    }).then(checkResponse);\r\n};\r\n//  ,   ,     ( refresh ),   -  refresh \r\nexport const getToken =()=>{\r\n  return new Promise<string>((resolve,reject)=>{\r\n  var token = getCookie(\"accessToken\");\r\n  if(!token){\r\n    refreshToken().then((res) => {\r\n      if (res && res.success) {\r\n        let aToken = res.accessToken.split(\"Bearer \")[1];\r\n        setCookie(\"accessToken\", aToken, { expires: 1200 });\r\n        setCookie(\"refreshToken\", res.refreshToken, {expires:\"never\"});\r\n        resolve(aToken);\r\n      }\r\n      reject(`: ${res.message}`);      \r\n    }      \r\n    ).catch((e)=>{ \r\n      deleteCookie(\"refreshToken\");\r\n      reject(e);\r\n    })   \r\n    \r\n  }\r\n  else resolve(token);\r\n}\r\n  )\r\n}\r\nexport function getCookie(name:string):string|undefined {\r\n  const matches = document.cookie.match(\r\n    new RegExp(\r\n      \"(?:^|; )\" +\r\n      // eslint-disable-next-line no-useless-escape\r\n      name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, \"\\\\$1\") +\r\n        \"=([^;]*)\"\r\n    )\r\n  );\r\n  return matches ? decodeURIComponent(matches[1]) : undefined;\r\n}\r\n\r\nexport function setCookie(name:string, value:string|null, props?:TCookieProps) {\r\n  props = props || {};\r\n  let exp = props.expires;\r\n  if (typeof exp == \"number\" && exp) {\r\n    const d = new Date();\r\n    d.setTime(d.getTime() + exp * 1000);\r\n    exp = props.expires = d;\r\n  }\r\n  if ((exp as Date) && (exp as Date).toUTCString) {\r\n    props.expires = (exp as Date).toUTCString();\r\n  }\r\n  value = value?encodeURIComponent(value as string):'';\r\n  let updatedCookie = name + \"=\" + value;\r\n  updatedCookie +=\";expires=\"+props.expires;\r\n  document.cookie = updatedCookie;\r\n}\r\n\r\nexport function deleteCookie(name:string) {\r\n  setCookie(name, null, { expires: -1 });\r\n}\r\n\r\nexport function dateToString(dtime:Date):string{\r\n  try{\r\n    var dt = new Date(dtime);\r\n    var day = dt.getFullYear()=== new Date().getFullYear() &&\r\n    dt.getMonth()=== new Date().getMonth() ? (dt.getDay() === new Date().getDay()?\"\":\r\n     new Date().getDay()-dt.getDay() === 1?\"\":`${new Date().getDay()-dt.getDay()}  `\r\n    ) :null;\r\n    if(day === null) day=`${dt.getFullYear()}-${dt.getMonth()}-${dt.getDay()}`;\r\n    return `${day}, ${dt.toLocaleTimeString()}`\r\n  \r\n  }catch(e){\r\n    return dtime.toString();\r\n  }\r\n    \r\n}\r\nexport const splitArray =(arr:ReadonlyArray<number>, chunkSize:number)=> {\r\n  var R = [];\r\n  for (var i = 0; i < arr.length; i += chunkSize)\r\n    R.push(arr.slice(i, i + chunkSize));\r\n  return R;\r\n}\r\n","import {\r\n  setCookie,\r\n  getCookie,\r\n  fetchWithRefresh,\r\n  fetchWithToken,\r\n  fetchData,\r\n} from \"../../utils/utils\";\r\nimport {\r\n  API_URL,\r\n  USER_URL,\r\n  REGISTER_URL,\r\n  FORGOT_PASSWORD_URL,\r\n  RESET_PASSWORD_URL,\r\n} from \"../../utils/burger-constants\";\r\nimport { AppThunk, TResetPassword, TUser } from \"../../utils/types\";\r\n\r\nexport const GET_USER_REQUEST = \"GET_USER_REQUEST\";\r\nexport const GET_USER_SUCCESS = \"GET_USER_SUCCESS\";\r\nexport const GET_USER_FAILED = \"GET_USER_FAILED\";\r\n\r\nexport const SET_USER_REQUEST = \"SET_USER_REQUEST\";\r\nexport const SET_USER_SUCCESS = \"SET_USER_SUCCESS\";\r\nexport const SET_USER_FAILED = \"SET_USER_FAILED\";\r\n\r\nexport const REG_USER_REQUEST = \"REG_USER_REQUEST\";\r\nexport const REG_USER_SUCCESS = \"REG_USER_SUCCESS\";\r\nexport const REG_USER_FAILED = \"REG_USER_FAILED\";\r\nexport const CLEAR_USER = \"CLEAR_USER\";\r\n\r\nexport const FORGOT_PASS_REQUEST = \"FORGOT_PASS_REQUEST\";\r\nexport const FORGOT_PASS_SUCCESS = \"FORGOT_PASS_SUCCESS\";\r\nexport const FORGOT_PASS_FAILED = \"FORGOT_PASS_FAILED\";\r\n\r\nexport const RESET_PASS_REQUEST = \"RESET_PASS_REQUEST\";\r\nexport const RESET_PASS_SUCCESS = \"RESET_PASS_SUCCESS\";\r\nexport const RESET_PASS_FAILED = \"RESET_PASS_FAILED\";\r\nexport interface IResetPassRequest{\r\n  readonly type: typeof RESET_PASS_REQUEST \r\n}\r\nexport interface IResetPassResult{\r\n  readonly type: typeof RESET_PASS_SUCCESS | typeof RESET_PASS_FAILED,\r\n  readonly message?:string \r\n}\r\nexport interface IForgotPassRequest{\r\n  readonly type: typeof FORGOT_PASS_REQUEST \r\n}\r\nexport interface IForgotPassResult{\r\n  readonly type: typeof FORGOT_PASS_FAILED | typeof FORGOT_PASS_SUCCESS,\r\n  readonly message?:string\r\n}\r\nexport interface ISetUserRequest{\r\n  readonly type:typeof SET_USER_REQUEST\r\n}\r\nexport interface ISetUserResult{\r\n  readonly type:typeof SET_USER_FAILED | typeof SET_USER_SUCCESS,\r\n  readonly user?:TUser\r\n}\r\nexport interface IGetUserRequest{\r\n  readonly type:typeof GET_USER_REQUEST\r\n}\r\nexport interface IGetUserResult{\r\n  readonly type:typeof GET_USER_FAILED | typeof GET_USER_SUCCESS,\r\n  readonly user?:TUser\r\n}\r\nexport interface IRegUserRequest{\r\n  readonly type:typeof REG_USER_REQUEST\r\n}\r\nexport interface IRegUserResult{\r\n  readonly type:typeof REG_USER_FAILED | typeof REG_USER_SUCCESS,\r\n  readonly user?:TUser|null\r\n}\r\n\r\nexport type TProfileActions = IResetPassRequest | IResetPassResult |IForgotPassRequest |IForgotPassResult\r\n|ISetUserRequest | ISetUserResult | IGetUserRequest | IGetUserResult | IRegUserRequest | IRegUserResult\r\nexport const resetPassRequest=():IResetPassRequest=>{\r\n  return {\r\n    type:RESET_PASS_REQUEST\r\n  }\r\n}\r\nexport const resetPassResult=(isSuccess:boolean, message?:string):IResetPassResult=>{\r\n  return {\r\n    type:isSuccess? RESET_PASS_SUCCESS: RESET_PASS_FAILED,\r\n    message\r\n  }\r\n}\r\nexport const forgotPasswordRequest =():IForgotPassRequest=>{\r\n  return{\r\n    type:FORGOT_PASS_REQUEST\r\n  }\r\n}\r\nexport const forgotPasswordResult =(isSuccess:boolean, message?:string):IForgotPassResult=>{\r\n  return{\r\n    type: isSuccess? FORGOT_PASS_SUCCESS: FORGOT_PASS_FAILED,\r\n    message\r\n  }\r\n}\r\nexport const setUserRequest=():ISetUserRequest=>{\r\n  return {\r\n    type: SET_USER_REQUEST\r\n  }\r\n}\r\nexport const setUserResult = (isSuccess:boolean, user?:TUser):ISetUserResult=>{\r\n  return{\r\n    type:  isSuccess? SET_USER_SUCCESS: SET_USER_FAILED,\r\n    user\r\n  }\r\n}\r\nexport const getUserRequest=():IGetUserRequest=>{\r\n  return {\r\n    type: GET_USER_REQUEST\r\n  }\r\n}\r\nexport const getUserResult = (isSuccess:boolean, user?:TUser):IGetUserResult=>{\r\n  return{\r\n    type:  isSuccess? GET_USER_SUCCESS: GET_USER_FAILED,\r\n    user\r\n  }\r\n}\r\nexport const regUserRequest=():IRegUserRequest=>{\r\n  return {\r\n    type: REG_USER_REQUEST\r\n  }\r\n}\r\nexport const regUserResult = (isSuccess:boolean, user?:TUser|null):IRegUserResult=>{\r\n  return{\r\n    type:  isSuccess? REG_USER_SUCCESS: REG_USER_FAILED,\r\n    user\r\n  }\r\n}\r\n\r\nexport function register(data:TUser) {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(regUserRequest());\r\n    fetchData(`${API_URL}${REGISTER_URL}`, \"POST\", JSON.stringify(data))\r\n      .then((res) => {\r\n        if (res && res.success) {\r\n          let aToken = res.accessToken.split(\"Bearer \")[1];\r\n          setCookie(\"accessToken\", aToken, { expires: 1200 });\r\n          setCookie(\"refreshToken\", res.refreshToken);\r\n          dispatch(regUserResult(true,res.user));\r\n        } else {\r\n          dispatch(regUserResult(false));\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        dispatch(regUserResult(false));\r\n      });\r\n  };\r\n}\r\n\r\nexport function getUser() {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(getUserRequest());\r\n    \r\n    fetchWithToken(`${API_URL}${USER_URL}`, \"GET\")\r\n        .then((res) => {\r\n          if (res && res.success) {\r\n            dispatch(getUserResult(true,res.user));\r\n          } else {\r\n            dispatch(getUserResult(false));\r\n            \r\n          }\r\n        })\r\n        .catch((e) => {\r\n          \r\n          if (\r\n            ((e.indexOf(\"expired\") > 0 || e.indexOf(\"invalid\") > 0) &&\r\n              e.indexOf(\"token\") > 0) ||\r\n            e.indexOf(\"403\")\r\n          )\r\n          {\r\n          \r\n            fetchWithRefresh(`${API_URL}${USER_URL}`, \"GET\")\r\n              .then((res) => {\r\n                if (res && res.success) {\r\n                  dispatch(getUserResult(true,res.user));\r\n                } else {\r\n                  dispatch(getUserResult(false));\r\n                }\r\n              })\r\n              .catch((e) => {\r\n                dispatch(getUserResult(false));\r\n              });\r\n            }\r\n          else{\r\n          dispatch(getUserResult(false));\r\n        \r\n        }\r\n        });\r\n  };\r\n}\r\n\r\nexport function setUser(data:TUser) {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(setUserRequest());\r\n    fetchWithToken(`${API_URL}${USER_URL}`, \"PATCH\", JSON.stringify(data))\r\n        .then((res) => {\r\n          if (res && res.success) {\r\n            dispatch(setUserResult(true, res.user));\r\n          } else {\r\n            dispatch(setUserResult(false));\r\n          }\r\n        })\r\n        .catch((e) => {\r\n          if (\r\n            (e.indexOf(\"expired\") > 0 || e.indexOf(\"invalid\") > 0) &&\r\n            e.indexOf(\"token\") > 0\r\n          )\r\n            fetchWithRefresh(\r\n              `${API_URL}${USER_URL}`,\r\n              \"PATCH\",\r\n              JSON.stringify(data)\r\n            )\r\n              .then((res) => {\r\n                if (res && res.success) {\r\n                  dispatch(setUserResult(true, res.user));\r\n                } else {\r\n                  dispatch(setUserResult(false));\r\n                }\r\n              })\r\n              .catch((e) => {\r\n                dispatch(setUserResult(false));\r\n              });\r\n          else\r\n            dispatch(setUserResult(false));\r\n        });\r\n  };\r\n}\r\n\r\nexport function forgotPassword(data:TUser) {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(forgotPasswordRequest());\r\n    fetchData(`${API_URL}${FORGOT_PASSWORD_URL}`, \"POST\", JSON.stringify(data))\r\n      .then((res) => {\r\n        if (res && res.success) {\r\n          dispatch(forgotPasswordResult(true,res.message));\r\n        } else {\r\n          dispatch(forgotPasswordResult(false));\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        dispatch(forgotPasswordResult(false));\r\n      });\r\n  };\r\n}\r\nexport function resetPassword(data:TResetPassword) {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(resetPassRequest());\r\n    fetchData(`${API_URL}${RESET_PASSWORD_URL}`, \"POST\", JSON.stringify(data))\r\n      .then((res) => {\r\n        if (res && res.success) {\r\n          dispatch(resetPassResult(true,res.message));\r\n        } else {\r\n          dispatch(resetPassResult(false));\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        dispatch(resetPassResult(false,e));\r\n      });\r\n  };\r\n}\r\n","import { API_URL, INGREDIENTS_URL } from \"../../utils/burger-constants\";\r\nimport { AppThunk, TIngredient } from \"../../utils/types\";\r\nimport { checkResponse } from \"../../utils/utils\";\r\nexport const GET_INGREDIENTS_REQUEST = \"GET_INGREDIENTS_REQUEST\";\r\nexport const GET_INGREDIENTS_SUCCESS = \"GET_INGREDIENTS_SUCCESS\";\r\nexport const GET_INGREDIENTS_FAILED = \"GET_INGREDIENTS_FAILED\";\r\nexport interface IGetIngredientsRequest{\r\n  readonly type: typeof GET_INGREDIENTS_REQUEST\r\n}\r\nexport interface IGetIngredientsSuccess{\r\n  readonly type: typeof GET_INGREDIENTS_SUCCESS\r\n  readonly ingredients:ReadonlyArray<TIngredient>\r\n}\r\nexport interface IGetIngredientsFailed{\r\n  readonly type: typeof GET_INGREDIENTS_FAILED\r\n}\r\nexport type TIngredientActions= IGetIngredientsFailed|IGetIngredientsRequest|IGetIngredientsSuccess\r\nexport const getIngredientsRequest =():IGetIngredientsRequest=>{\r\n  return{\r\n    type: GET_INGREDIENTS_REQUEST\r\n  }\r\n}\r\nexport const getIngredientsSuccess =(ingredients:ReadonlyArray<TIngredient>):IGetIngredientsSuccess=>{\r\n  return{\r\n    type: GET_INGREDIENTS_SUCCESS,\r\n    ingredients\r\n  }\r\n}\r\nexport const getIngredientsFailed =():IGetIngredientsFailed=>{\r\n  return{\r\n    type: GET_INGREDIENTS_FAILED\r\n  }\r\n}\r\nexport function getIngredients() {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(getIngredientsRequest());\r\n    fetch(`${API_URL}${INGREDIENTS_URL}`)\r\n      .then(checkResponse)\r\n      .then((res) => {\r\n        if (res && res.success) {\r\n          dispatch( getIngredientsSuccess( res.data ));\r\n        } else {\r\n          dispatch(getIngredientsFailed());\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        dispatch(getIngredientsFailed());\r\n      });\r\n  };\r\n}\r\n","import { Redirect, Route } from \"react-router-dom\";\r\nimport { useSelector } from \"../../utils/hooks\";\r\nimport React from \"react\";\r\ntype TRouteProps ={\r\n  path:string,\r\n  exact?:boolean\r\n}\r\nexport const ProtectedRoute :React.FC<TRouteProps>=(props)=> {\r\n  const { user } = useSelector((store) => store.profile);\r\n\r\n  return (\r\n    <Route\r\n      {...props}\r\n      render={() =>\r\n        user? (\r\n          props.children\r\n        ) : (\r\n          <Redirect\r\n            to={{\r\n              pathname: \"/login\",\r\n            }}\r\n          />\r\n        )\r\n      }\r\n    />\r\n  );\r\n}\r\n","export default __webpack_public_path__ + \"static/media/close.c4c517b0.svg\";","import React from 'react';\r\nimport styles from './modal-overlay.module.css'\r\nimport { TModalProps } from '../../utils/types';\r\n\r\nconst  ModalOverlay:React.FC<TModalProps> = (props) => {\r\n    return(\r\n        <div id=\"modalOverlay\" className={styles.background} onClick={props.onClose}>{props.children}</div>\r\n    )\r\n}\r\n  \r\nexport default ModalOverlay;","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport styles from './modal.module.css';\r\nimport CloseImg from '../../images/close.svg'\r\nimport ModalOverlay from '../modal-overlay/modal-overlay';\r\nimport { TModalProps } from '../../utils/types';\r\nconst  Modal:React.FC<TModalProps> = (props) => {\r\n  const { children, header, onClose } = props;\r\n  const modalRoot:Element|null = document.getElementById(\"react-modals\");\r\n  const onKeydown = ({ key }:{key:string}) => {\r\n    if(key ==='Escape') onClose()\r\n  }\r\n  React.useEffect(() => {\r\n    document.addEventListener('keydown', onKeydown);\r\n    return () => document.removeEventListener('keydown', onKeydown);\r\n  // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  },[]);\r\n  return (modalRoot?ReactDOM.createPortal(\r\n      <ModalOverlay onClose={onClose}>\r\n        <div className={`pl-10 pt-10 pr-10 pb-15 ${styles.modal}`} onClick={e=>e.stopPropagation()}>\r\n        <div className={styles.header}>\r\n          <span className=\"text text_type_main-large\">{header}</span>\r\n          <img className=\"ml-2\" onClick={onClose}  src={CloseImg} alt=\"\"/>\r\n        </div>\r\n        {children}          \r\n        </div>\r\n      </ModalOverlay>,\r\n      modalRoot\r\n    )\r\n    : null\r\n  )  \r\n} \r\nexport default Modal","import { TIngredient } from \"../../utils/types\";\r\n\r\nexport const ADD_INGREDIENT: \"ADD_INGREDIENT\" = \"ADD_INGREDIENT\";\r\nexport const REMOVE_INGREDIENT: \"REMOVE_INGREDIENT\" = \"REMOVE_INGREDIENT\";\r\nexport const MOVE_INGREDIENT: \"MOVE_INGREDIENT\" = \"MOVE_INGREDIENT\";\r\nexport const CLEAR_INGREDIENTS: \"CLEAR_INGREDIENTS\" = \"CLEAR_INGREDIENTS\";\r\nexport interface IAddIngredient{\r\n    readonly type:typeof ADD_INGREDIENT,\r\n    readonly item:TIngredient\r\n}\r\nexport interface IClearIngredients{\r\n    readonly type : typeof CLEAR_INGREDIENTS\r\n}\r\nexport interface IRemoveIngredient{\r\n    readonly type : typeof REMOVE_INGREDIENT,\r\n    readonly place:number\r\n}\r\nexport interface IMoveIngredient{\r\n    readonly type : typeof MOVE_INGREDIENT,\r\n    readonly oldPlace:number,\r\n    readonly newPlace:number,\r\n}\r\nexport type TBurgerIngredientActions= IAddIngredient|IClearIngredients|IRemoveIngredient|IMoveIngredient\r\nexport const addIngredient=(ingredient:TIngredient):IAddIngredient=>{\r\n    return{\r\n        type:ADD_INGREDIENT,\r\n        item:ingredient\r\n    }\r\n}\r\nexport const clearIngredients=():IClearIngredients=>{\r\n    return {\r\n        type:CLEAR_INGREDIENTS\r\n    }\r\n}\r\nexport const removeIngredient=(place:number):IRemoveIngredient=>{\r\n    return{\r\n        type: REMOVE_INGREDIENT,\r\n        place:place\r\n    }\r\n}\r\nexport const moveIngredient =(oldPlace:number, newPlace:number):IMoveIngredient=>{\r\n    return{\r\n        type:MOVE_INGREDIENT,\r\n        oldPlace:oldPlace,\r\n        newPlace:newPlace\r\n    }\r\n}","import React from \"react\";\r\nimport styles from \"./burger-element.module.css\";\r\nimport { DragIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { ConstructorElement } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport {\r\n  removeIngredient,\r\n  moveIngredient,\r\n} from \"../../services/actions/burger-constructor\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport {  DropTargetMonitor, useDrag, useDrop } from \"react-dnd\";\r\nimport {TAddedIngredient, TDraggingElement} from \"../../utils/types\";\r\nconst BurgerElement : React.FC<TAddedIngredient>=(props)=> {\r\n  const dispatch = useDispatch();\r\n  const deleteIngredient = () => {\r\n    dispatch(removeIngredient( props.place ));\r\n  };\r\n  const ref = React.useRef<HTMLSpanElement>(null);\r\n  const [, dropRef] = useDrop({\r\n    accept: \"moving\",\r\n    hover(item:TDraggingElement, monitor:DropTargetMonitor<TDraggingElement,unknown>) {\r\n      if (!ref.current) {\r\n        return;\r\n      }\r\n      const dragIndex = item.index;\r\n      const hoverIndex = props.index?props.index:0;\r\n      if (dragIndex === hoverIndex) {\r\n        return;\r\n      }\r\n      const hoverBoundingRect = ref.current?.getBoundingClientRect();\r\n      const hoverMiddleY =\r\n        (hoverBoundingRect.bottom - hoverBoundingRect.top) / 2;\r\n      const clientOffset = monitor.getClientOffset();\r\n      if(clientOffset === null) return;\r\n      const hoverClientY =  clientOffset.y - hoverBoundingRect.top;\r\n      if (dragIndex < hoverIndex && hoverClientY < hoverMiddleY) {\r\n        return;\r\n      }\r\n      if (dragIndex > hoverIndex && hoverClientY > hoverMiddleY) {\r\n        return;\r\n      }\r\n      dispatch(moveIngredient( dragIndex, hoverIndex ));\r\n      item.index = hoverIndex;\r\n    },\r\n  });\r\n  const [, dragRef] = useDrag({\r\n    type: \"moving\",\r\n    item: ():TDraggingElement => {\r\n      return { id: props._id, index: props.index?props.index:0 };\r\n    },\r\n  });\r\n  dropRef(dragRef(ref));\r\n\r\n  return (\r\n    <span className={styles.element} ref={ref}>\r\n      {props.isLocked ? (\r\n        <span className=\"pr-8\" />\r\n      ) : (\r\n        <>\r\n          <DragIcon type=\"primary\"/>\r\n          <span className=\"pr-1\"></span>\r\n        </>\r\n      )}\r\n\r\n      <ConstructorElement {...props} handleClose={deleteIngredient} />\r\n    </span>\r\n  );\r\n}\r\n\r\nexport default React.memo(BurgerElement);\r\n","import React from \"react\";\r\nimport { Button } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { CurrencyIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport styles from \"./submit-order.module.css\";\r\nimport { useSelector } from \"../../utils/hooks\";\r\ntype TSubmitOrderProps={\r\n  onClick : (e:React.SyntheticEvent)=>void\r\n}\r\nconst SubmitOrder:React.FC<TSubmitOrderProps> = (props) => {\r\n  const { price } = useSelector((store) => store.constructor);\r\n  return (\r\n    <form onSubmit={props.onClick}>\r\n      <span className={styles.submit}>\r\n        <p className=\"text text_type_digits-medium mr-2\">{price ? price : 0}</p>\r\n        <CurrencyIcon type=\"primary\" />\r\n        <span className=\"pl-10\" />\r\n        <Button type=\"primary\" size=\"medium\">\r\n           \r\n        </Button>\r\n      </span>\r\n    </form>\r\n  );\r\n}\r\nexport default SubmitOrder;\r\n","export default __webpack_public_path__ + \"static/media/done.cc5a59a7.gif\";","import styles from \"./order-details.module.css\";\r\nimport DoneGif from \"../../images/done.gif\";\r\nimport { useSelector } from \"../../utils/hooks\";\r\n\r\nfunction OrderDetails() {\r\n  const { orderId } = useSelector((store) => store.order);\r\n  return (\r\n    <div className={`${styles.flexcol}`}>\r\n      <p className=\"text text_type_digits-medium\">{orderId}</p>\r\n      <p className=\"text text_type_main-medium pt-8\"> </p>\r\n      <img\r\n        src={DoneGif}\r\n        className=\"pt-15 pb-15\"\r\n        alt=\"   \"\r\n      ></img>\r\n      <p className=\"text text_type_main-small pb-2\">\r\n           \r\n      </p>\r\n      <p className=\"text text_type_main-small text_color_inactive\">\r\n            \r\n      </p>\r\n    </div>\r\n  );\r\n}\r\nexport default OrderDetails;\r\n","import { API_URL, GET_ORDER_ID_URL } from \"../../utils/burger-constants\";\r\nimport { AppThunk, TOrder, TOrderShortDetails } from \"../../utils/types\";\r\nimport { fetchData, fetchWithToken, fetchWithRefresh } from \"../../utils/utils\";\r\nexport const SUBMIT_ORDER_REQUEST:\"SUBMIT_ORDER_REQUEST\" = \"SUBMIT_ORDER_REQUEST\";\r\nexport const SUBMIT_ORDER_SUCCESS:\"SUBMIT_ORDER_SUCCESS\" = \"SUBMIT_ORDER_SUCCESS\";\r\nexport const SUBMIT_ORDER_FAILED:\"SUBMIT_ORDER_FAILED\" = \"SUBMIT_ORDER_FAILED\";\r\nexport const GET_ORDER_REQUEST:\"GET_ORDER_REQUEST\" = \"GET_ORDER_REQUEST\";\r\nexport const GET_ORDER_SUCCESS:\"GET_ORDER_SUCCESS\" = \"GET_ORDER_SUCCESS\";\r\nexport const GET_ORDER_FAILED:\"GET_ORDER_FAILED\" = \"GET_ORDER_FAILED\";\r\nexport const RESET_ORDER:\"RESET_ORDER\" = \"RESET_ORDER\";\r\nexport interface ISubmitOrderRequest{\r\n  readonly type: typeof SUBMIT_ORDER_REQUEST\r\n}\r\nexport interface ISubmitOrderResult{\r\n  readonly type: typeof SUBMIT_ORDER_SUCCESS | typeof SUBMIT_ORDER_FAILED,\r\n  readonly order?:TOrderShortDetails\r\n}\r\nexport interface IResetOrder{\r\n  readonly type:typeof RESET_ORDER\r\n}\r\nexport interface IGetOrderRequest{\r\n  readonly type: typeof GET_ORDER_REQUEST\r\n}\r\nexport interface IGetOrderResult{\r\n  readonly type: typeof GET_ORDER_SUCCESS | typeof GET_ORDER_FAILED,\r\n  readonly order?:TOrder\r\n}\r\nexport type TOrderActions = ISubmitOrderRequest | ISubmitOrderResult | IResetOrder | IGetOrderRequest | IGetOrderResult\r\nexport const submitOrderRequest=():ISubmitOrderRequest=>{\r\n  return {\r\n    type:SUBMIT_ORDER_REQUEST\r\n  }\r\n}\r\nexport const submitOrderResult=(isSuccess:boolean,order?:TOrderShortDetails):ISubmitOrderResult=>{\r\n  return {\r\n    type: isSuccess? SUBMIT_ORDER_SUCCESS : SUBMIT_ORDER_FAILED,\r\n    order\r\n  }\r\n}\r\nexport const resetOrder = ():IResetOrder=>{\r\n  return {\r\n    type: RESET_ORDER\r\n  }\r\n}\r\nexport const getOrderRequest=():IGetOrderRequest=>{\r\n  return {\r\n    type:GET_ORDER_REQUEST\r\n  }\r\n}\r\nexport const getOrderResult=(isSuccess:boolean,order?:TOrder):IGetOrderResult=>{\r\n  return {\r\n    type: isSuccess? GET_ORDER_SUCCESS : GET_ORDER_FAILED,\r\n    order\r\n  }\r\n}\r\nexport function submitOrder(data:ReadonlyArray<string>) {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(submitOrderRequest());\r\n    \r\n    \r\n      fetchWithToken(`${API_URL}${GET_ORDER_ID_URL}`, \"POST\",JSON.stringify({ ingredients: data }))\r\n       .then((res) => {\r\n        if (res && res.success) {\r\n          dispatch(submitOrderResult(true,{number:res.order.number, _id:res.name}));\r\n        } else {\r\n          dispatch(submitOrderResult(false));\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        if (\r\n          ((e.indexOf(\"expired\") > 0 || e.indexOf(\"invalid\") > 0) &&\r\n            e.indexOf(\"token\") > 0) ||\r\n          e.indexOf(\"403\")\r\n        )\r\n          fetchWithRefresh(`${API_URL}${GET_ORDER_ID_URL}`, \"POST\",JSON.stringify({ ingredients: data }))\r\n            .then((res) => {\r\n              if (res && res.success) {\r\n                dispatch(submitOrderResult(true,{number:res.order.number, _id:res.name}));\r\n              } else {\r\n                dispatch(submitOrderResult(false));\r\n              }\r\n            })\r\n            .catch((e) => {\r\n              dispatch(submitOrderResult(false));\r\n            });\r\n        else\r\n        dispatch(submitOrderResult(false));\r\n\r\n      }); \r\n    \r\n      \r\n  };\r\n}\r\nexport function getOrder(number:number){\r\nreturn function (dispatch:AppThunk){\r\n  dispatch(getOrderRequest());\r\n  fetchData(`${API_URL}${GET_ORDER_ID_URL}/${number}`,\"GET\")\r\n  .then((res)=>{\r\n    if(res && res.success && res.orders.length>0){\r\n      dispatch(getOrderResult(true, res.orders[0]));\r\n    }else{\r\n      dispatch(getOrderResult(false));\r\n    }\r\n  }).catch(e=>{\r\n    \r\n    dispatch(getOrderResult(false));\r\n  }\r\n  )    \r\n}\r\n}\r\n","export const SET_ERROR: \"SET_ERROR\" = \"SET_ERROR\";\r\nexport const CLEAR_ERROR: \"CLEAR_ERROR\" = \"CLEAR_ERROR\";\r\nexport interface ISetError{\r\n    readonly type:typeof SET_ERROR,\r\n    readonly error:string\r\n}\r\nexport interface IClearError{\r\n    readonly type:typeof CLEAR_ERROR\r\n}\r\nexport type TErrorActions = ISetError|IClearError\r\nexport const setError=(errorText:string):ISetError=>{\r\n    return {\r\n        type:SET_ERROR,\r\n        error:errorText\r\n    }\r\n}\r\nexport const clearError=():IClearError=>{\r\n    return{\r\n        type:CLEAR_ERROR\r\n    }\r\n}\r\n","import React, { useMemo } from \"react\";\r\nimport styles from \"./burger-constructor.module.css\";\r\nimport BurgerElement from \"../burger-element/burger-element\";\r\nimport SubmitOrder from \"../submit-order/submit-order\";\r\nimport OrderDetails from \"../order-details/order-details\";\r\nimport Modal from \"../modal/modal\";\r\nimport { resetOrder } from \"../../services/actions/order-details\";\r\nimport { useSelector, useDispatch } from \"../../utils/hooks\";\r\nimport { submitOrder } from \"../../services/actions/order-details\";\r\nimport { setError } from \"../../services/actions/error\";\r\nimport {\r\n  addIngredient,\r\n  clearIngredients,\r\n} from \"../../services/actions/burger-constructor\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { useDrop } from \"react-dnd\";\r\nimport {TAddedIngredient,TIngredient, TDraggingElement} from \"../../utils/types\";\r\n\r\nfunction BurgerConstructor() {\r\n  const history = useHistory();\r\n  const { burger } = useSelector((store) => store.constructor);\r\n  const { user } = useSelector((store) => store.profile);\r\n  const { ingredients } = useSelector((store) => store.ingredients);\r\n  const { orderId, submitOrderFailed } = useSelector((store) => store.order);\r\n  const dispatch = useDispatch();\r\n  const top = useMemo(\r\n    () => (burger ? burger.filter((b:TAddedIngredient) => b.type === \"top\")[0] : null),\r\n    [burger]\r\n  );\r\n  const bottom = useMemo(\r\n    () => (burger ? burger.filter((b:TAddedIngredient) => b.type === \"bottom\")[0] : null),\r\n    [burger]\r\n  );\r\n  const middleIngredients = useMemo(\r\n    () => (burger ? burger.filter((ingr:TAddedIngredient) => ingr.type !== \"bottom\" && ingr.type !== \"top\") : null),\r\n    [burger]\r\n  );\r\n  const closeModal = () => {\r\n    dispatch(resetOrder());\r\n    dispatch(clearIngredients());\r\n  };\r\n\r\n  const onSubmit = (e:React.SyntheticEvent) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    if (!user) history.replace({ pathname: \"/login\" });\r\n    if (!burger || burger.filter((i:TAddedIngredient) => i.type === \"bottom\" || i.type === \"top\").length === 0)\r\n      dispatch(setError( \"     .\" ));\r\n    else dispatch(submitOrder(burger.map((ingr:TAddedIngredient) => ingr._id)));\r\n  };\r\n\r\n  const [, dropTarget] = useDrop({\r\n    accept: \"ingredient\",\r\n    drop(item:TDraggingElement) {\r\n      dispatch(addIngredient(ingredients.filter((ingr:TIngredient) => ingr._id === item.id)[0]));\r\n    },\r\n  });\r\n\r\n  React.useEffect(() => {\r\n    if (submitOrderFailed)\r\n      dispatch(setError(\"   .   .\"));\r\n  }, [dispatch, submitOrderFailed]);\r\n  return (\r\n    <>\r\n      <div className={styles.burger} ref={dropTarget}>\r\n        {Boolean(burger && burger.length) && (\r\n          <>\r\n            {top && <BurgerElement {...top} isLocked={true}></BurgerElement>}\r\n            <div className=\"pb-4\" />\r\n            {middleIngredients && (\r\n              <div className={styles.scrollable}>\r\n                {middleIngredients.map((ingredient:TAddedIngredient, index:number) => (\r\n                  <React.Fragment key={ingredient.place}>\r\n                    <BurgerElement\r\n                      {...ingredient}\r\n                      index={ingredient.place}\r\n                    ></BurgerElement>\r\n                    <div className=\"pb-4\" />\r\n                  </React.Fragment>\r\n                ))}\r\n              </div>\r\n            )}\r\n            <div className=\"pb-4\" />\r\n            {bottom && (\r\n              <BurgerElement {...bottom} isLocked={true}></BurgerElement>\r\n            )}\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"pt-10\"></div>\r\n      <SubmitOrder onClick={onSubmit} />\r\n      {orderId && (\r\n        <Modal onClose={closeModal} header=\"\">\r\n          <OrderDetails />\r\n        </Modal>\r\n      )}\r\n    </>\r\n  );\r\n}\r\nexport default BurgerConstructor;\r\n","import React, {FC} from \"react\" ;\r\nimport { TAddedIngredient, TIngredient } from \"../../utils/types\";\r\nimport styles from \"./burger-ingredient-card.module.css\";\r\nimport {\r\n  Counter,\r\n  CurrencyIcon,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { useSelector } from \"../../utils/hooks\";\r\nimport { useDrag, DragPreviewImage } from \"react-dnd\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\n\r\nconst BurgerIngredientCard:FC<TIngredient> = (props) => {\r\n  const counter = useSelector((store) =>\r\n    store.constructor.burger\r\n      ? store.constructor.burger.filter(\r\n          (ingr:TAddedIngredient) => ingr._id === props._id\r\n        ).length\r\n      : 0\r\n  );\r\n  const [, dragRef, preview] = useDrag({ \r\n    type: \"ingredient\",\r\n    item: { id: props._id },\r\n    collect: (monitor) => ({\r\n      isDrag: monitor.isDragging(),\r\n    }),\r\n  });\r\n  const location = useLocation();\r\n  return (\r\n    <Link\r\n      key={props._id}\r\n      to={{\r\n        pathname: `/ingredient/${props._id}`,\r\n        state: { background: location },\r\n      }}\r\n      className={styles.link}\r\n    >\r\n      <DragPreviewImage connect={preview} src={props.image} />\r\n      <div className={styles.ingredient_card} ref={dragRef}>\r\n        {counter !== 0 && <Counter count={counter} size=\"default\" />}\r\n        <img\r\n          src={props.image}\r\n          className={`ml-4 mr-4 mb-1 ${styles.img}`}\r\n          alt={props.name}\r\n        />\r\n        <span className={styles.price_div}>\r\n          <p className=\"text text_type_digits-default mr-2 \">\r\n            {props.price}\r\n          </p>\r\n          <CurrencyIcon type=\"primary\" />\r\n        </span>\r\n        <p className={`text text_type_main-small mt-1 ${styles.item_center}`}>\r\n          {props.name}\r\n        </p>\r\n      </div>\r\n    </Link>\r\n  );\r\n}\r\n\r\nexport default BurgerIngredientCard;\r\n","export const SET_TAB:\"SET_TAB\" = \"SET_TAB\";\r\nexport const SET_RATIO:\"SET_RATIO\" = \"SET_RATIO\";\r\nexport interface ISetTab{\r\n    readonly type: typeof SET_TAB,\r\n    readonly current:string,\r\n}\r\nexport interface ISetRatio{\r\n    readonly type: typeof SET_RATIO,\r\n    readonly id:string,\r\n    readonly ratio:number\r\n}\r\nexport type TTabActions=ISetRatio|ISetTab\r\nexport const setTab=(currentTab:string):ISetTab=>{\r\n    return{\r\n        type:SET_TAB,\r\n        current:currentTab\r\n    }\r\n}\r\nexport const setRatio = (id:string, ratio:number):ISetRatio=>{\r\n    return{\r\n        type:SET_RATIO,\r\n        id:id,\r\n        ratio:ratio\r\n    }\r\n}\r\n","import React, { useMemo } from \"react\";\r\nimport BurgerIngredientCard from \"../burger-ingredient-card/burger-ingredient-card\";\r\nimport styles from \"./burger-ingredients-tab.module.css\";\r\nimport { useSelector, useDispatch } from \"../../utils/hooks\";\r\nimport { setRatio } from \"../../services/actions/tab\";\r\nimport { useInView } from \"react-intersection-observer\";\r\nimport { TIngredient, TMenuTab } from \"../../utils/types\";\r\n\r\nconst BurgerIngredientsTab:React.FC<TMenuTab>=(props) =>{\r\n  const { ingredients } = useSelector((store) => store.ingredients);\r\n  const { ref, inView, entry } = useInView({\r\n    //   ,       entry\r\n    threshold: [0, 0.25, 0.5, 0.75, 1],\r\n  });\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const filteredIngredients = useMemo(\r\n    () => ingredients.filter((ingredient:TIngredient) => ingredient.type === props.id),\r\n    [ingredients, props.id]\r\n  );\r\n  React.useEffect(() => {\r\n    dispatch(setRatio( props.id, entry ? entry.intersectionRatio : 0 ));\r\n  }, [inView, entry, dispatch, props.id]); //   /,  ratio\r\n\r\n  return (\r\n    <>\r\n      <p className=\"text text_type_main-medium pl-4 pt-6 pb-10\" id={props.id}>\r\n        {props.title}\r\n      </p>\r\n      <div className={styles.ingretients_tab} ref={ref}>\r\n        {filteredIngredients.map((ingredient:TIngredient) => (\r\n          <BurgerIngredientCard\r\n            key={ingredient._id}\r\n            {...ingredient}\r\n          ></BurgerIngredientCard>\r\n        ))}\r\n      </div>\r\n    </>\r\n  );\r\n}\r\nexport default BurgerIngredientsTab;\r\n","import React from \"react\";\r\nimport styles from \"./burger-ingredients.module.css\";\r\nimport { Tab } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport BurgerIngredientsTab from \"../burger-ingredients-tab/burger-ingredients-tab\";\r\nimport { useSelector, useDispatch } from \"../../utils/hooks\";\r\nimport { setError, clearError } from \"../../services/actions/error\";\r\nimport { setTab } from \"../../services/actions/tab\";\r\nimport { TMenuTab } from \"../../utils/types\";\r\n\r\nfunction BurgerIngredients() {\r\n  const { ingredientsRequest, ingredientsFailed } = useSelector(\r\n    (store) => store.ingredients\r\n  );\r\n  const { tabs, current } = useSelector((store) => store.tab);\r\n  const dispatch = useDispatch();\r\n\r\n  React.useEffect(() => {\r\n    const element = document.getElementById(current);\r\n    element?.scrollIntoView();\r\n  }, [current]);\r\n  React.useEffect(() => {\r\n    if (ingredientsFailed)\r\n      dispatch(setError(\"   \" ));\r\n    else dispatch(clearError());\r\n  }, [dispatch, ingredientsFailed]);\r\n  const setActiveTab = (value:string) => {\r\n    dispatch(setTab(value));\r\n  };\r\n\r\n  return (\r\n    <div className={\" pt-10\"}>\r\n      <p className=\"text text_type_main-large\"> </p>\r\n      <div className=\"mt-5 mb-10\" style={{ display: \"flex\" }}>\r\n        {ingredientsFailed ? (\r\n          <p className=\"text text_type_main-large\"> .</p>\r\n        ) : ingredientsRequest ? (\r\n          <p className=\"text text_type_main-large\">...</p>\r\n        ) : (\r\n          <>\r\n            {tabs.map((tab:TMenuTab, index:number) => (\r\n              <Tab\r\n                key={index}\r\n                value={tab.id}\r\n                active={tab.id === current}\r\n                onClick={setActiveTab}\r\n              >\r\n                {tab.title}\r\n              </Tab>\r\n            ))}\r\n          </>\r\n        )}\r\n      </div>\r\n      <div className={styles.ingredients}>\r\n        <BurgerIngredientsTab id=\"bun\" title=\"\" ratio={1}></BurgerIngredientsTab>\r\n        <BurgerIngredientsTab id=\"sauce\" title=\"\" ratio={0}></BurgerIngredientsTab>\r\n        <BurgerIngredientsTab\r\n          id=\"main\"\r\n          title=\"\"\r\n          ratio={0}\r\n        ></BurgerIngredientsTab>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport default BurgerIngredients;\r\n","import styles from \"./constructor.module.css\";\r\nimport BurgerConstructor from \"../components/burger-constructor/burger-constructor\";\r\nimport BurgerIngredients from \"../components/burger-ingredients/burger-ingredients\";\r\nimport React from \"react\";\r\nimport Modal from \"../components/modal/modal\";\r\nimport { useSelector, useDispatch } from \"../utils/hooks\";\r\nimport { CLEAR_ERROR } from \"../services/actions/error\";\r\nimport { DndProvider } from \"react-dnd\";\r\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\r\nexport const ConstructorPage = () => {\r\n  const { error } = useSelector((store) => store.error);\r\n  const dispatcher = useDispatch();\r\n\r\n  return (\r\n    <>\r\n      <main className={styles.main}>\r\n        <DndProvider backend={HTML5Backend}>\r\n          <section className={`pl-9 ${styles.section}`}>\r\n            <BurgerIngredients />\r\n          </section>\r\n          <div className=\"ml-10\" />\r\n          <section className={`mt-25 pr-9 ${styles.section}`}>\r\n            <BurgerConstructor />\r\n          </section>\r\n        </DndProvider>\r\n        {error && (\r\n          <Modal\r\n            header=\" :(\"\r\n            onClose={() => dispatcher({ type: CLEAR_ERROR })}\r\n          >\r\n            <span className=\"text text_type_main-medium\">{`\"${error}\"`}</span>\r\n          </Modal>\r\n        )}\r\n      </main>\r\n    </>\r\n  );\r\n};\r\n","import {\r\n  setCookie,\r\n  deleteCookie,\r\n  getCookie,\r\n  fetchData,\r\n} from \"../../utils/utils\";\r\nimport { API_URL, LOGIN_URL, LOGOUT_URL } from \"../../utils/burger-constants\";\r\nimport {AppThunk, TUser} from \"../../utils/types\"\r\n\r\nexport const LOGIN_REQUEST = \"LOGIN_REQUEST\";\r\nexport const LOGIN_SUCCESS = \"LOGIN_SUCCESS\";\r\nexport const LOGIN_FAILED = \"LOGIN_FAILED\";\r\n\r\nexport const LOGOUT_REQUEST = \"LOGOUT_REQUEST\";\r\nexport const LOGOUT_SUCCESS = \"LOGOUT_SUCCESS\";\r\nexport const LOGOUT_FAILED = \"LOGOUT_FAILED\";\r\nexport interface ILoginRequest{\r\n  readonly type: typeof LOGIN_REQUEST,\r\n}\r\nexport interface ILoginSuccess{\r\n  readonly type: typeof LOGIN_SUCCESS,\r\n  readonly user:TUser\r\n}\r\nexport interface ILoginFailed{\r\n  readonly type: typeof LOGIN_FAILED,\r\n}\r\nexport interface ILogoutRequest{\r\n  readonly type: typeof LOGOUT_REQUEST,\r\n}\r\nexport interface ILogoutSuccess{\r\n  readonly type: typeof LOGOUT_SUCCESS,\r\n}\r\nexport interface ILogoutFailed{\r\n  readonly type: typeof LOGOUT_FAILED,\r\n}\r\nexport type TLoginActions = ILoginFailed|ILoginRequest|ILoginSuccess|ILogoutFailed|ILogoutRequest|ILogoutSuccess;\r\nexport const loginRequest=():ILoginRequest=>{\r\n  return {\r\n    type:LOGIN_REQUEST\r\n  }\r\n}\r\nexport const loginSucccess=(user:TUser):ILoginSuccess=>{\r\n  return {\r\n    type:LOGIN_SUCCESS,\r\n    user\r\n  }\r\n}\r\nexport const loginFailed=():ILoginFailed=>{\r\n  return {\r\n    type:LOGIN_FAILED\r\n  }\r\n}\r\nexport const logoutRequest=():ILogoutRequest=>{\r\n  return {\r\n    type:LOGOUT_REQUEST\r\n  }\r\n}\r\nexport const logoutSucccess=():ILogoutSuccess=>{\r\n  return {\r\n    type:LOGOUT_SUCCESS\r\n  }\r\n}\r\nexport const logoutFailed=():ILogoutFailed=>{\r\n  return {\r\n    type:LOGOUT_FAILED\r\n  }\r\n}\r\nexport function login(data:TUser) {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(loginRequest());\r\n    fetchData(`${API_URL}${LOGIN_URL}`, \"POST\", JSON.stringify(data))\r\n      .then((res) => {\r\n        if (res && res.success) {\r\n          let aToken = res.accessToken.split(\"Bearer \")[1];\r\n          setCookie(\"accessToken\", aToken, { expires: 1200 });\r\n          setCookie(\"refreshToken\", res.refreshToken);\r\n          dispatch(loginSucccess(res.user));\r\n        } else {\r\n          dispatch(loginFailed());\r\n        }\r\n      })\r\n      .catch((e) => {\r\n        dispatch(loginFailed());\r\n      });\r\n  };\r\n}\r\nexport function logout() {\r\n  return function (dispatch:AppThunk) {\r\n    dispatch(logoutRequest());\r\n    if (!getCookie(\"refreshToken\"))\r\n      dispatch(logoutSucccess());\r\n    else\r\n      fetchData(\r\n        `${API_URL}${LOGOUT_URL}`,\r\n        \"POST\",\r\n        JSON.stringify({ token: getCookie(\"refreshToken\") })\r\n      )\r\n        .then((res) => {\r\n          if (res && res.success) {\r\n            deleteCookie(\"accessToken\");\r\n            deleteCookie(\"refreshToken\");\r\n            dispatch(logoutSucccess());\r\n          } else {\r\n            dispatch(logoutFailed());\r\n          }\r\n        })\r\n        .catch((e) => {\r\n           dispatch(logoutFailed());\r\n        });\r\n  };\r\n}\r\n","import styles from \"./awaiter.module.css\";\r\nexport const Awaiter = () => {\r\n  return (\r\n    <div className={styles.main}>\r\n      <div className={styles.inner}>\r\n        <p className=\"text text_type_main-large m-20\">\r\n          ,  ...\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./login.module.css\";\r\nimport { Link, Redirect, useLocation } from \"react-router-dom\";\r\nimport { useSelector, useDispatch } from \"../utils/hooks\";\r\nimport { login } from \"../services/actions/login\";\r\nimport { setError, clearError } from \"../services/actions/error\";\r\nimport {\r\n  EmailInput,\r\n  PasswordInput,\r\n  Button,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { Awaiter } from \"../components/awaiter/awaiter\";\r\nimport { TLocationState } from \"../utils/types\";\r\n\r\nexport const LoginPage = () => {\r\n  const [emailValue, setEmailValue] = React.useState<string>(\"\");\r\n  const [passValue, setPassValue] = React.useState<string>(\"\");\r\n  const { error } = useSelector((store) => store.error);\r\n  const { loginRequestFailed } = useSelector((store) => store.login);\r\n  const { profileRequest, user } = useSelector((store) => store.profile);\r\n  const dispatch = useDispatch();\r\n  const location = useLocation<TLocationState>();\r\n  const LogInClick = (e:React.SyntheticEvent) => {\r\n    e.preventDefault();\r\n    dispatch(clearError());\r\n    dispatch(login({ email: emailValue, password: passValue }));\r\n  };\r\n  React.useEffect(() => {\r\n    if (loginRequestFailed)\r\n      dispatch(setError(\"    \"));\r\n    else dispatch(clearError());\r\n  }, [dispatch, loginRequestFailed]);\r\n\r\n  const onChangeEmail = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setEmailValue(e.target.value);\r\n  };\r\n  const onChangePass = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setPassValue(e.target.value);\r\n  };\r\n  return user ? (\r\n    <Redirect\r\n      to={\r\n        location.state?.from?.pathname === \"/exit\"\r\n          ? \"/\"\r\n          : location.state?.from || \"/\"\r\n      }\r\n    />\r\n  ) : profileRequest ? (\r\n    <>\r\n      <Awaiter />\r\n    </>\r\n  ) : (\r\n    <form onSubmit={LogInClick}>\r\n      <div className={styles.main}>\r\n        <div className={styles.inner}>\r\n          <p className=\"text text_type_main-large mb-6\"></p>\r\n          <div className={styles.item}>\r\n            <EmailInput\r\n              size=\"default\"\r\n              onChange={onChangeEmail}\r\n              value={emailValue}\r\n              name={\"email\"}\r\n            />\r\n          </div>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <PasswordInput\r\n              size=\"default\"\r\n              onChange={onChangePass}\r\n              value={passValue}\r\n              name={\"password\"}\r\n            />\r\n          </div>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <Button type=\"primary\" size=\"small\">\r\n              \r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"mt-20\">\r\n            {error && <p className=\"text text_type_main-medium\">{error}</p>}\r\n            <p className=\"text text_type_main-small\">\r\n               -  ?{\" \"}\r\n              <Link to=\"/register\"></Link>\r\n            </p>\r\n          </div>\r\n          <div className=\"mt-4\">\r\n            <p className=\"text text_type_main-small\">\r\n               ?{\" \"}\r\n              <Link to=\"/forgot-password\"> </Link>\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n","import { Link } from \"react-router-dom\";\r\nimport styles from \"./page404.module.css\";\r\n\r\nexport const Code404Page = () => {\r\n  return (\r\n    <>\r\n      <main className={styles.main}>\r\n        <div>\r\n          <section className={styles.section}>\r\n            <p className=\"text text_type_digits-large\">404</p>\r\n          </section>\r\n          <section className={styles.section}>\r\n            <p className=\"text text_type_main-large\">  </p>\r\n            <Link to=\"/\">\r\n              <span className=\"text text_type_main-medium\"> </span>\r\n            </Link>\r\n          </section>\r\n        </div>\r\n      </main>\r\n    </>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./login.module.css\";\r\nimport { useSelector, useDispatch } from \"../utils/hooks\";\r\nimport { setError, clearError } from \"../services/actions/error\";\r\nimport { register } from \"../services/actions/profile\";\r\nimport { Redirect, Link } from \"react-router-dom\";\r\nimport {\r\n  Input,\r\n  PasswordInput,\r\n  Button,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { Awaiter } from \"../components/awaiter/awaiter\";\r\nexport const RegisterPage = () => {\r\n  const [emailValue, setEmailValue] = React.useState(\"\");\r\n  const [passValue, setPassValue] = React.useState(\"\");\r\n  const [nameValue, setNameValue] = React.useState(\"\");\r\n  const { user, regRequestFailed, regRequest } = useSelector(\r\n    (store) => store.profile\r\n  );\r\n  const { error } = useSelector((store) => store.error);\r\n  const dispatch = useDispatch();\r\n  const onSubmit = (e:React.SyntheticEvent) => {\r\n    e.preventDefault();\r\n    dispatch(clearError());\r\n    dispatch(\r\n      register({ email: emailValue, password: passValue, name: nameValue })\r\n    );\r\n  };\r\n  React.useEffect(() => {\r\n    if (regRequestFailed)\r\n      dispatch(setError( \"  \" ));\r\n  }, [dispatch, regRequestFailed]);\r\n  const onChangeEmail = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setEmailValue(e.target.value);\r\n  };\r\n  const onChangeName = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setNameValue(e.target.value);\r\n  };\r\n  const onChangePass = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setPassValue(e.target.value);\r\n  };\r\n  if (user) {\r\n    return (\r\n      <Redirect\r\n        to={{\r\n          pathname: \"/\",\r\n        }}\r\n      />\r\n    );\r\n  }\r\n  return regRequest ? (\r\n    <Awaiter />\r\n  ) : (\r\n    <form onSubmit={onSubmit}>\r\n      <div className={styles.main}>\r\n        <div className={styles.inner}>\r\n          <p className=\"text text_type_main-large mb-6\"></p>\r\n\r\n          <div className={styles.item}>\r\n            <Input\r\n              type={\"text\"}\r\n              placeholder={\"\"}\r\n              onChange={onChangeName}\r\n              value={nameValue}\r\n              size={\"default\"}\r\n            />\r\n          </div>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <Input\r\n              type={\"text\"}\r\n              placeholder={\"E-mail\"}\r\n              onChange={onChangeEmail}\r\n              value={emailValue}\r\n              size={\"default\"}\r\n            />\r\n          </div>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <PasswordInput\r\n              size=\"default\"\r\n              onChange={onChangePass}\r\n              value={passValue}\r\n              name={\"password\"}\r\n            />\r\n          </div>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <Button type=\"primary\" size=\"small\">\r\n              \r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"mt-20\">\r\n            {error && <p className=\"text text_type_main-large mb-6\">{error}</p>}\r\n            <p className=\"text text_type_main-small\">\r\n               ? <Link to=\"/login\"></Link>\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./forgot-password.module.css\";\r\nimport {\r\n  Input,\r\n  Button,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { useDispatch, useSelector } from \"../utils/hooks\";\r\nimport { forgotPassword } from \"../services/actions/profile\";\r\nimport { setError, clearError } from \"../services/actions/error\";\r\nimport { useHistory, Redirect, Link } from \"react-router-dom\";\r\nimport { Awaiter } from \"../components/awaiter/awaiter\";\r\nexport const ForgotPasswordPage = () => {\r\n  const [emailValue, setEmailValue] = React.useState(\"\");\r\n\r\n  const {\r\n    profileRequest,\r\n    profileRequestFailed,\r\n    passwordResetRequired,\r\n    message,\r\n  } = useSelector((store) => store.profile);\r\n  const { loggedIn } = useSelector((store) => store.login);\r\n  const { error } = useSelector((store) => store.error);\r\n  const dispatch = useDispatch();\r\n  const history = useHistory();\r\n  const onSubmit = (e:React.SyntheticEvent) => {\r\n    e.preventDefault();\r\n    dispatch(clearError());\r\n    dispatch(forgotPassword({ email: emailValue }));\r\n  };\r\n  const onChangeEmail = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setEmailValue(e.target.value);\r\n  };\r\n  React.useEffect(() => {\r\n    if (profileRequestFailed && emailValue){\r\n      if(typeof message === \"string\") dispatch(setError(message));\r\n    }\r\n    else if (\r\n      passwordResetRequired &&\r\n      !profileRequest &&\r\n      !profileRequestFailed\r\n    ) {\r\n      history.replace({ pathname: \"/reset-password\", state: history.location });\r\n    }\r\n  }, [\r\n    dispatch,\r\n    profileRequestFailed,\r\n    emailValue,\r\n    passwordResetRequired,\r\n    message,\r\n    profileRequest,\r\n    history,\r\n  ]);\r\n\r\n  return loggedIn ? (\r\n    <Redirect to=\"/\" />\r\n  ) : profileRequest ? (\r\n    <>\r\n      <Awaiter />\r\n    </>\r\n  ) : (\r\n    <>\r\n      <form onSubmit={onSubmit}>\r\n        <div className={styles.main}>\r\n          <div className={styles.inner}>\r\n            <p className=\"text text_type_main-large mb-6\">\r\n               \r\n            </p>\r\n            <span className=\"mb-6\"></span>\r\n            <div className={styles.item}>\r\n              <Input\r\n                type=\"text\"\r\n                placeholder=\" e-mail\"\r\n                onChange={onChangeEmail}\r\n                value={emailValue}\r\n                size=\"default\"\r\n              />\r\n            </div>\r\n            <span className=\"mb-6\"></span>\r\n            <div className={styles.item}>\r\n              <Button type=\"primary\" size=\"small\">\r\n                \r\n              </Button>\r\n            </div>\r\n\r\n            <div className=\"mt-20\">\r\n              {error && <p className=\"text text_type_main-small\">{error}</p>}\r\n              <p className=\"text text_type_main-small\">\r\n                 ? <Link to=\"/login\"></Link>\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport { Awaiter } from \"../components/awaiter/awaiter\";\r\nimport styles from \"./reset-password.module.css\";\r\nimport { useSelector, useDispatch } from \"../utils/hooks\";\r\nimport { Link, Redirect, useHistory } from \"react-router-dom\";\r\n\r\nimport {\r\n  Input,\r\n  Button,\r\n  PasswordInput,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { resetPassword } from \"../services/actions/profile\";\r\nimport { setError, clearError } from \"../services/actions/error\";\r\nimport { TLocationState } from \"../utils/types\";\r\n\r\nexport const ResetPasswordPage = () => {\r\n  const [value, setValue] = React.useState(\"\");\r\n  const [passValue, setPassValue] = React.useState(\"\");\r\n  const {\r\n    user,\r\n    message,\r\n    profileRequestFailed,\r\n    profileRequest,\r\n    passwordReseted,\r\n  } = useSelector((store) => store.profile);\r\n  const { error } = useSelector((store) => store.error);\r\n  const dispatch = useDispatch();\r\n  const history = useHistory<TLocationState>();\r\n  const onSubmit = (e:React.SyntheticEvent) => {\r\n    e.preventDefault();\r\n    dispatch(clearError());\r\n    dispatch(resetPassword({ password: passValue, token: value }));\r\n  };\r\n  React.useEffect(() => {\r\n    if (profileRequestFailed && passValue){\r\n      if(typeof message === \"string\") dispatch(setError( message ));\r\n    }\r\n    else if (passwordReseted && !profileRequest && !profileRequestFailed) {\r\n      history.replace({ pathname: \"/login\" });\r\n    }\r\n  }, [\r\n    dispatch,\r\n    profileRequestFailed,\r\n    passwordReseted,\r\n    passValue,\r\n    message,\r\n    profileRequest,\r\n    history,\r\n  ]);\r\n\r\n  const onChange = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setValue(e.target.value);\r\n  };\r\n  const onChangePass = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    setPassValue(e.target.value);\r\n  };\r\n  if (history.location.state?.pathname !== \"/forgot-password\")\r\n    return <Redirect to=\"/forgot-password\" />;\r\n  return user ? (\r\n    <Redirect to=\"/\" />\r\n  ) : profileRequest ? (\r\n    <Awaiter />\r\n  ) : (\r\n    <form onSubmit={onSubmit}>\r\n      <div className={styles.main}>\r\n        <div className={styles.inner}>\r\n          <p className=\"text text_type_main-large mb-6\">\r\n             \r\n          </p>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <PasswordInput\r\n              size=\"default\"\r\n              onChange={onChangePass}\r\n              value={passValue}\r\n              name={\"password\"}\r\n            />\r\n          </div>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <Input\r\n              type=\"text\"\r\n              placeholder=\"   \"\r\n              onChange={onChange}\r\n              value={value}\r\n              size=\"default\"\r\n            />\r\n          </div>\r\n          <span className=\"mb-6\"></span>\r\n          <div className={styles.item}>\r\n            <Button type=\"primary\" size=\"small\">\r\n              \r\n            </Button>\r\n          </div>\r\n\r\n          <div className=\"mt-20\">\r\n            {error && <p className=\"text text_type_main-small\">{error}</p>}\r\n            <p className=\"text text_type_main-small\">\r\n               ? <Link to=\"/login\"></Link>\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\n","import React from \"react\";\r\nimport styles from \"./profile-data.module.css\";\r\nimport {\r\n  Input,\r\n  EmailInput,\r\n  PasswordInput,\r\n  Button,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { useDispatch, useSelector } from \"../../utils/hooks\";\r\nimport { setUser } from \"../../services/actions/profile\";\r\nimport { setError, clearError } from \"../../services/actions/error\";\r\n\r\nconst ProfileData = () => {\r\n  const [emailValue, setEmailValue] = React.useState<string|null>(null);\r\n  const [nameValue, setNameValue] = React.useState<string|null>(null);\r\n\r\n  const { user, setProfileRequest, setProfileRequestFailed } = useSelector(\r\n    (store) => store.profile\r\n  );\r\n  const { error } = useSelector((store) => store.error);\r\n  const dispatch = useDispatch();\r\n  const onCancel = () => {\r\n    setEmailValue(null);\r\n    setNameValue(null);\r\n  };\r\n  const onSave = (e:React.SyntheticEvent) => {\r\n    e.stopPropagation();\r\n    e.preventDefault();\r\n    dispatch(clearError());\r\n    dispatch(\r\n      setUser({ name: nameValue || user?.name , email: emailValue || user?.email || '' })\r\n    );\r\n  };\r\n  const onChangeEmail = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    e.preventDefault();\r\n    setEmailValue(e.target.value);\r\n  };\r\n  const onChangePass = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    e.preventDefault();\r\n  };\r\n  const onChangeName = (e:React.ChangeEvent<HTMLInputElement>) => {\r\n    e.preventDefault();\r\n    setNameValue(e.target.value);\r\n  };\r\n  React.useEffect(() => {\r\n    if (setProfileRequestFailed) {\r\n      dispatch(setError(\"   \" ));\r\n\r\n      setEmailValue(null);\r\n      setNameValue(null);\r\n    }\r\n  }, [user, dispatch, setProfileRequestFailed]);\r\n  return (\r\n    <form onSubmit={onSave}>\r\n      <div className={styles.main}>\r\n        <div className={styles.item}>\r\n          <Input\r\n            placeholder=\"\"\r\n            icon={\"EditIcon\"}\r\n            size=\"default\"\r\n            onChange={onChangeName}\r\n            value={nameValue || nameValue === \"\" ? nameValue : user?.name || ''}\r\n          ></Input>\r\n        </div>\r\n        <span className=\"mb-6\"></span>\r\n        <div className={styles.item}>\r\n          <EmailInput\r\n            name=\"Email\"\r\n            size=\"default\"\r\n            onChange={onChangeEmail}\r\n            value={emailValue || emailValue === \"\" ? emailValue : user?.email || ''}\r\n          ></EmailInput>\r\n        </div>\r\n        <span className=\"mb-6\"></span>\r\n        <div className={styles.item}>\r\n          <PasswordInput\r\n            size=\"default\"\r\n            name=\"password\"\r\n            value={\"\"}\r\n            onChange={onChangePass}\r\n          ></PasswordInput>\r\n        </div>\r\n        <span className=\"mt-6\" />\r\n        {((emailValue && emailValue !== user?.email) ||\r\n          (nameValue && nameValue !== user?.name)) && (\r\n          <div className={styles.item}>\r\n            <span className=\"mr-3\">\r\n            <Button type=\"primary\" size=\"medium\" >\r\n              \r\n            </Button>\r\n            </span>\r\n            <span className=\"ml-3\">\r\n            <Button\r\n              type=\"primary\"\r\n              size=\"medium\"\r\n              \r\n              onClick={onCancel}\r\n            >\r\n              \r\n            </Button>\r\n            </span>\r\n          </div>\r\n        )}\r\n        <div className={styles.item}>\r\n          <p className=\"text text_type_main-medium\">\r\n            {setProfileRequest ? \"  \" : error}\r\n          </p>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  );\r\n};\r\nexport default ProfileData;\r\n","import React from \"react\";\r\nimport { useSelector } from \"../../../utils/hooks\";\r\nimport { TIngredient, TOrderIngredients } from \"../../../utils/types\";\r\nimport styles from \"./ingredient-row.module.css\";\r\nimport { useMemo } from \"react\";\r\nimport { CurrencyIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\n\r\nconst IngredientRow:React.FC<TOrderIngredients> = (props)=>{\r\n    const { ingredients } = useSelector((store) => store.ingredients);\r\n    const selectedIngreients = useMemo(()=>{\r\n    var si:Array<TIngredient>=[];\r\n      props.ingredients.forEach(\r\n          (i)=>{\r\n              let ingr = ingredients.find((ingr)=>ingr._id===i)\r\n              if(ingr) si.push({...ingr})\r\n          }        \r\n      ) ;\r\n      return si;\r\n        },[props,ingredients]  \r\n    )\r\n    const price = useMemo(()=>selectedIngreients.length === 0?0: selectedIngreients.map((ingr)=>ingr.price).reduce((s,price)=>s+price),[selectedIngreients]);\r\n    \r\nreturn(\r\n    <div className={styles.main} >\r\n<div className={styles.img_container} style={{padding:`0 0 0 ${36*(props.ingredients.length-1)}px`}} >\r\n   {selectedIngreients&& selectedIngreients.map((ingr:TIngredient, index:number)=>\r\n   (       \r\n       <img key={index} src={ingr.image} className={styles.item} style={{margin:`0 0 0 ${index*36*-1}px`}} alt={ingr.name}></img>\r\n    )\r\n   )} \r\n</div>\r\n\r\n<span className={styles.price_div}>\r\n          <p className=\"text text_type_digits-default mr-2 \">\r\n            {price}\r\n          </p>\r\n          <CurrencyIcon type=\"primary\" />\r\n    </span>\r\n    \r\n</div>\r\n)\r\n}\r\nexport default IngredientRow","import React from \"react\";\r\nimport { TOrder } from \"../../../utils/types\";\r\nimport IngredientRow from \"../ingredient-row/ingredient-row\";\r\nimport styles from \"./order-card.module.css\";\r\nimport { dateToString } from \"../../../utils/utils\";\r\nimport { Link, useLocation } from \"react-router-dom\";\r\nconst OrderCard:React.FC<TOrder> = (props)=>{\r\n    const location = useLocation();\r\n    \r\nreturn(\r\n    <Link\r\n      key={props.number}\r\n      to={{\r\n        pathname:  `${location.pathname}${location.pathname[location.pathname.length-1]===\"/\"?\"\":\"/\"}${props.number}`,\r\n        state: { background: location },\r\n      }}\r\n      className={styles.link}\r\n    >\r\n<div className={`p-6 mt-3 mb-3 ${styles.card}`}>\r\n    <div className={styles.row}><p className=\"text text_type_digits-default\" >#{props.number}</p>\r\n    <p className=\"text text_type_main-default text_color_inactive\" >{dateToString(props.createdAt)}</p>\r\n    </div>\r\n    <p className=\"mt-6 mb-6 text text_type_main-medium\">{props.name}</p>\r\n    {props.status && <p className={`mt-2 mb-6 text text_type_main-small ${props.status===\"done\"?styles.green:\"\"}`}>{props.status===\"done\"?\"\":props.status}</p>}\r\n    {props.ingredients && <IngredientRow  ingredients={props.ingredients} ></IngredientRow>}   \r\n    \r\n</div>\r\n</Link>\r\n)\r\n}\r\nexport default OrderCard","import styles from \"./profile-orders-data.module.css\";\r\nimport OrderCard from \"../orders-info/order-card/order-card\";\r\nimport { useSelector } from \"../../utils/hooks\";\r\nimport { TOrder } from \"../../utils/types\";\r\nconst ProfileOrdersData=()=>{\r\n    const { orders } = useSelector(store=>store.ws);\r\n  \r\nreturn(\r\n\r\n    <section className={styles.scrollable}>\r\n        <span className=\"ml-6\" >\r\n        {orders && orders.length>0 ? orders.map((order:TOrder, index:number)=>\r\n            <OrderCard {...order} key={index} ></OrderCard>\r\n        ):(\r\n            <p className=\"mb-6  text text_type_main-medium\">  </p>\r\n        )\r\n        }\r\n    </span>\r\n    </section>\r\n    \r\n   \r\n)\r\n}\r\nexport default ProfileOrdersData;","import { TOrder, TWSResponse } from \"../../utils/types\";\r\n\r\nimport { WS_URL, ORDERS_ALL_URL,USER_ORDERS_URL   } from \"../../utils/burger-constants\";\r\nimport { getCookie } from \"../../utils/utils\";\r\nexport const WS_CONNECTION_START:\"WS_CONNECTION_START\" =\"WS_CONNECTION_START\";\r\nexport const WS_CONNECTION_SUCCESS:\"WS_CONNECTION_SUCCESS\" =\"WS_CONNECTION_SUCCESS\";\r\nexport const WS_CONNECTION_ERROR:\"WS_CONNECTION_ERROR\" =\"WS_CONNECTION_ERROR\";\r\nexport const WS_CONNECTION_CLOSED:\"WS_CONNECTION_CLOSED\" =\"WS_CONNECTION_CLOSED\";\r\nexport const WS_GET_MESSAGE:\"WS_GET_MESSAGE\" =\"WS_GET_MESSAGE\";\r\nexport const WS_SEND_MESSAGE:\"WS_SEND_MESSAGE\" =\"WS_SEND_MESSAGE\";\r\nexport const WS_CLOSE_CONNECTION:\"WS_CLOSE_CONNECTION\"=\"WS_CLOSE_CONNECTION\";\r\nexport interface IStartConnection{\r\n    readonly type:typeof WS_CONNECTION_START,\r\n    readonly payload:string\r\n}\r\nexport interface IConnectionStarted{\r\n    readonly type:typeof WS_CONNECTION_SUCCESS\r\n}\r\nexport interface IConnectionError{\r\n    readonly type:typeof WS_CONNECTION_ERROR,\r\n    readonly payload?:Event,\r\n}\r\nexport interface IConnectionClosed{\r\n    readonly type:typeof WS_CONNECTION_CLOSED\r\n}\r\nexport interface IGetMessage{\r\n    readonly type:typeof WS_GET_MESSAGE,\r\n    readonly payload:TWSResponse\r\n}\r\nexport interface ISendMessage{\r\n    readonly type:typeof WS_SEND_MESSAGE,\r\n    readonly payload:TOrder\r\n}\r\nexport interface ICloseConnection{\r\n    readonly type:typeof WS_CLOSE_CONNECTION\r\n}\r\nexport type TWSActions = IStartConnection | IConnectionStarted |IConnectionError |IConnectionClosed |IGetMessage |ISendMessage | ICloseConnection;\r\nexport const startConnection=(token :string):IStartConnection|IConnectionError=>{\r\n    const wsUrl = token?`${WS_URL}${USER_ORDERS_URL}?token=${token}`:`${WS_URL}${ORDERS_ALL_URL}`;\r\n    return{\r\n        type:WS_CONNECTION_START,\r\n        payload:wsUrl\r\n    }\r\n}\r\nexport const closeConnection=():ICloseConnection=>{\r\n    return{\r\n        type:WS_CLOSE_CONNECTION,\r\n        \r\n    }\r\n}\r\nexport const connectionStarted=():IConnectionStarted=>{\r\n    return{\r\n        type:WS_CONNECTION_SUCCESS\r\n    }\r\n}\r\nexport const connectionError=(evt:Event|undefined):IConnectionError=>{\r\n    return{\r\n        type:WS_CONNECTION_ERROR,\r\n        payload:evt,\r\n    }\r\n}\r\nexport const connectionClosed=():IConnectionClosed=>{\r\n    return{\r\n        type:WS_CONNECTION_CLOSED\r\n    }\r\n}\r\nexport const getMessage=(msg:string):IGetMessage=>{\r\n    const answer:TWSResponse = JSON.parse(msg);\r\n    return{\r\n        type:WS_GET_MESSAGE,\r\n        payload:answer\r\n    }\r\n}\r\nexport const sendMessage=(msg:TOrder):ISendMessage=>{\r\n    return{\r\n        type:WS_SEND_MESSAGE,\r\n        payload:msg\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport ProfileData from \"../components/profile-data/profile-data\";\r\nimport ProfileOrdersData from \"../components/profile-orders-data/profile-orders-data\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport styles from \"./profile.module.css\";\r\nimport { useLocation, Redirect } from \"react-router-dom\";\r\nimport { useDispatch, useSelector } from \"../utils/hooks\";\r\nimport { logout } from \"../services/actions/login\";\r\nimport {startConnection, closeConnection} from \"../services/actions/ws\";\r\nimport { getToken } from \"../utils/utils\";\r\n\r\nexport const ProfilePage = () => {\r\n  const location = useLocation();\r\n  const dispatch = useDispatch();\r\n  const { user } = useSelector((store) => store.profile);\r\n  React.useEffect(() => {\r\n    if (location.pathname === \"/exit\") {\r\n      dispatch(logout());\r\n    }\r\n  }, [location, dispatch]);\r\n  React.useEffect(()=>{   \r\n    getToken().then((res)=>{\r\n     dispatch(startConnection(res));\r\n    })\r\n    .catch((e)=>{\r\n      dispatch(logout());\r\n    })\r\nreturn ()=>{ dispatch(closeConnection())}\r\n  },[dispatch])\r\n    \r\n  return !user ? (\r\n    <Redirect to=\"/login\" />\r\n  ) : (\r\n    <main className={styles.main}>\r\n      <section className={styles.section}>\r\n        <nav>\r\n          <div className={styles.divLink}>\r\n            <NavLink\r\n              className={\"text text_type_main-medium \" + styles.link}\r\n              to=\"/profile\"\r\n            >\r\n              <p\r\n                className={\r\n                  location.pathname === \"/profile\" ? styles.alink : styles.link\r\n                }\r\n              >\r\n                {\" \"}\r\n                \r\n              </p>\r\n            </NavLink>\r\n          </div>\r\n          <div className={styles.divLink}>\r\n            <NavLink\r\n              className={\"text text_type_main-medium \" + styles.link}\r\n              to=\"/profile/orders\"\r\n            >\r\n              <p\r\n                className={\r\n                  location.pathname === \"/profile/orders\"\r\n                    ? styles.alink\r\n                    : styles.link\r\n                }\r\n              >\r\n                {\" \"}\r\n                 \r\n              </p>\r\n            </NavLink>\r\n          </div>\r\n          <div className={styles.divLink}>\r\n            <NavLink\r\n              className={\"text text_type_main-medium \" + styles.link}\r\n              to=\"/exit\"\r\n            >\r\n              <p\r\n                className={\r\n                  location.pathname === \"/exit\" ? styles.alink : styles.link\r\n                }\r\n              >\r\n                {\" \"}\r\n                \r\n              </p>\r\n            </NavLink>\r\n          </div>\r\n\r\n          <div className={`pt-20 ${styles.divLink}`}>\r\n            <p className=\"text text_type_main-small mt-3 mb-3\">\r\n                      \r\n            </p>\r\n          </div>\r\n        </nav>\r\n      </section>\r\n      <span className=\"mr-15\"></span>\r\n      <section className={styles.section}>\r\n        {location.pathname === \"/profile\" && <ProfileData />}\r\n        {location.pathname === \"/profile/orders\" && <ProfileOrdersData />}\r\n      </section>\r\n    </main>\r\n  );\r\n};\r\n","import React, {FC} from'react';\r\nimport { TIngredient } from \"../../utils/types\";\r\nimport styles from \"./ingredient-details.module.css\";\r\nconst  IngredientDetails: FC<TIngredient> = (props) => {\r\n  return (\r\n    <div className={styles.details_card}>\r\n      <img src={props.image_large} alt={props.name}></img>\r\n      <p className=\"text text_type_main-medium pt-4 pb-8\">\r\n        {props.name}\r\n      </p>\r\n      <div\r\n        className={`text text_type_main-small text_color_inactive ${styles.details}`}\r\n      >\r\n        <div className={styles.details_part}>\r\n          <p>, </p>\r\n          <p>{props.calories}</p>\r\n        </div>\r\n        <div className=\"pl-5\"></div>\r\n        <div className={styles.details_part}>\r\n          <p>, </p>\r\n          <p>{props.proteins}</p>\r\n        </div>\r\n        <div className=\"pl-5\"></div>\r\n        <div className={styles.details_part}>\r\n          <p>, </p>\r\n          <p>{props.fat}</p>\r\n        </div>\r\n        <div className=\"pl-5\"></div>\r\n        <div className={styles.details_part}>\r\n          <p>, </p>\r\n          <p>{props.carbohydrates}</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\nexport default IngredientDetails;\r\n","export const SET_CURRENT_INGREDIENT: \"SET_CURRENT_INGREDIENT\" =\r\n  \"SET_CURRENT_INGREDIENT\";\r\nexport const CLEAR_CURRENT_INGREDIENT: \"CLEAR_CURRENT_INGREDIENT\" =\r\n  \"CLEAR_CURRENT_INGREDIENT\";\r\nexport interface ISetCurrentIngredient{\r\n  readonly type: typeof SET_CURRENT_INGREDIENT,\r\n  readonly id:string\r\n}\r\nexport interface IClearCurrentIngredient{\r\n  readonly type: typeof CLEAR_CURRENT_INGREDIENT\r\n}\r\nexport type TCurrentIngredientActions= ISetCurrentIngredient|IClearCurrentIngredient\r\nexport const setCurrentIngredient =(ingredientId:string):ISetCurrentIngredient=>{\r\n  return{\r\n    type:SET_CURRENT_INGREDIENT,\r\n    id:ingredientId\r\n  }\r\n}\r\nexport const clearCurrentIngredient =():IClearCurrentIngredient=>{\r\n  return{\r\n    type:CLEAR_CURRENT_INGREDIENT\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport { useSelector, useDispatch } from \"../utils/hooks\";\r\nimport IngredientDetails from \"../components/ingredient-details/ingredient-details\";\r\nimport styles from \"./ingredient-details.module.css\";\r\nimport { Awaiter } from \"../components/awaiter/awaiter\";\r\nimport { useParams } from \"react-router-dom\";\r\n\r\nimport { setCurrentIngredient } from \"../services/actions/ingredient-details\";\r\nimport { TIngredient } from \"../utils/types\";\r\nexport const IngredientDetailsPage = () => {\r\n  let { id }:{id:string} = useParams();\r\n  const currentIngredient = useSelector((store) =>\r\n    store.ingredients.ingredients.find((i:TIngredient) => i._id === id)\r\n  );\r\n  const { ingredientsRequest, ingredientsFailed } = useSelector(\r\n    (store) => store.ingredients\r\n  );\r\n  const dispatcher = useDispatch();\r\n  React.useEffect(() => {\r\n    dispatcher(setCurrentIngredient(id));\r\n  }, [dispatcher, id]);\r\n  return ingredientsRequest ? (\r\n    <>\r\n      <Awaiter />\r\n    </>\r\n  ) : ingredientsFailed ? (\r\n    <p className=\"text text_type_main-large\">   </p>\r\n  ) : (\r\n    <>\r\n      <main className={styles.main}>\r\n        <section className={styles.section}>\r\n          {currentIngredient && (\r\n            <IngredientDetails {...currentIngredient} />\r\n          )}\r\n        </section>\r\n      </main>\r\n    </>\r\n  );\r\n};\r\n","import styles from \"./order-ingredients-list.module.css\";\r\nimport React, { useMemo } from \"react\";\r\nimport { TOrderIngredients,TIngredient } from \"../../../utils/types\";\r\nimport { CurrencyIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { useSelector } from \"../../../utils/hooks\";\r\n\r\nconst OrderIngredientsList:React.FC<TOrderIngredients>=(props)=>{\r\n    const { ingredients } = useSelector((store) => store.ingredients);\r\n    const selectedIngreients = useMemo(()=>{\r\n    var si:Array<TIngredient&{cnt:number}>=[];\r\n      props.ingredients.forEach(\r\n          (i)=>{\r\n              let ingr = ingredients.find((ingr)=>ingr._id===i)\r\n          if(ingr){\r\n            si.some(c=>c._id===i)?si[si.findIndex(c=>c._id===i)].cnt++:\r\n            si.push({...ingr, cnt:1})\r\n          }\r\n        }\r\n      );\r\n      return si; \r\n    },[props, ingredients])  \r\n \r\nreturn(\r\n    <div className={styles.scrollable}>\r\n        \r\n        {selectedIngreients && selectedIngreients.length>0 && selectedIngreients.map((ingr:TIngredient&{cnt:number}, index:number) => (\r\n        <div className={styles.container} key={index}>\r\n        \r\n        <img src={ingr.image} className={`m-2 ${styles.item}`} alt={ingr.name}></img>\r\n        <p className=\"m-2 text text_type_main-small\" >{ingr.name}</p>       \r\n        \r\n        <span className={`m-2 ${styles.price_div}`}>\r\n          <p className=\"text text_type_digits-default mr-2 \">\r\n            {ingr.cnt}x{ingr.price}\r\n          </p>\r\n          <CurrencyIcon type=\"primary\" />\r\n        </span>\r\n\r\n        </div>\r\n        \r\n        ))}\r\n            \r\n    </div>\r\n)\r\n}\r\nexport default OrderIngredientsList;","import styles from \"./order-details-extended.module.css\";\r\nimport React, {useMemo} from \"react\";\r\nimport OrderIngredientsList from \"../order-ingredients-list/order-ingredients-list\";\r\nimport { TOrder } from \"../../../utils/types\";\r\nimport { CurrencyIcon } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport { useSelector } from \"../../../utils/hooks\";\r\nimport { dateToString } from \"../../../utils/utils\";\r\nimport {TIngredient} from \"../../../utils/types\";\r\n\r\nconst OrderDetailsExtended:React.FC<TOrder> = (props)=>{\r\n    const { ingredients } = useSelector((store) => store.ingredients);\r\n    const selectedIngreients = useMemo(()=>{\r\n    var si:Array<TIngredient>=[];\r\n      props.ingredients.forEach(\r\n          (i)=>{\r\n              let ingr = ingredients.find((ingr)=>ingr._id===i)\r\n              if(ingr) si.push({...ingr})\r\n          }        \r\n      )   \r\n      return si;\r\n        },[ingredients,props])\r\n    const price = useMemo(()=>selectedIngreients.length === 0?0: selectedIngreients.map((ingr)=>ingr.price).reduce((s,price)=>s+price),[selectedIngreients]);\r\n    \r\nreturn(\r\n    <div className={styles.main}>\r\n    <p className=\"mt-20 text text_type_digits-default\" >#{props.number}</p>\r\n    <p className=\"mb-6 mt-6  text text_type_main-medium\">{props.name}</p>\r\n    <p className={`mt-3 mb-6 text text_type_main-small ${props.status===\"done\"?styles.green:\"\"}`}>{props.status===\"done\"?\"\":props.status}</p>    \r\n    <p className=\"mb-6 mt-3  text text_type_main-default\">:</p>\r\n    <OrderIngredientsList ingredients={props.ingredients} />\r\n    <div className={`${styles.horizontal} mt-6`}>\r\n    <p className=\"mb-6  text text_type_main-small text_color_inactive\">{dateToString(props.createdAt)}</p>\r\n    \r\n    <span className={styles.price_div}>\r\n          <p className=\"text text_type_digits-default mr-2 \">\r\n            {price}\r\n          </p>\r\n          <CurrencyIcon type=\"primary\" />\r\n        </span>\r\n        </div>\r\n    </div>\r\n)\r\n}\r\nexport default OrderDetailsExtended;","import styles from \"./order-details.module.css\";\r\nimport React from \"react\";\r\nimport { useParams } from \"react-router-dom\";\r\nimport OrderDetailsExtended from \"../components/orders-info/order-details-extended/order-details-extended\";\r\nimport { useDispatch, useSelector } from \"../utils/hooks\";\r\nimport { Awaiter } from \"../components/awaiter/awaiter\";\r\nimport { getOrder } from \"../services/actions/order-details\";\r\nimport { setError, clearError } from \"../services/actions/error\";\r\nimport Modal from \"../components/modal/modal\";\r\n\r\nexport const OrderDetailsPage= ()=>{\r\n    let { id }:{id:string} = useParams();\r\n  const {getOrderRequest, getOrderFailed, order} = useSelector(store=>store.order);\r\n  const{error} = useSelector(store=>store.error);\r\n  const dispatch=useDispatch();\r\n  React.useEffect(()=>{\r\n     dispatch(getOrder(Number(id)));\r\n  },[dispatch,id]\r\n  )\r\n  React.useEffect(()=>{\r\n    \r\n    if(getOrderFailed ) dispatch(setError(\"    \"));\r\n    if(getOrderRequest) dispatch(clearError());\r\n    \r\n },[dispatch,getOrderFailed,getOrderRequest]\r\n\r\n)\r\nreturn(  \r\n    <div className={styles.window}>\r\n    {order?\r\n    (<main className={styles.main}>\r\n      <section className={styles.section}>\r\n     {order && <OrderDetailsExtended {...order} ></OrderDetailsExtended>}\r\n        \r\n      </section>\r\n    </main>\r\n    ):\r\n    getOrderRequest?\r\n    (\r\n      <Awaiter/>\r\n    ):\r\n    (null)\r\n}\r\n{error && (\r\n          <Modal\r\n            header=\" :(\"\r\n            onClose={() => dispatch(clearError())}\r\n          >\r\n            <span className=\"text text_type_main-medium\">{`\"${error}\"`}</span>\r\n          </Modal>\r\n        )}\r\n  </div>\r\n)\r\n}\r\n","import React  from \"react\";\r\nimport {TOrderQuantity} from \"../../../utils/types\";\r\nconst OrdersReady:React.FC<TOrderQuantity>=(props)=>{\r\n    return(\r\n        <div className=\"mt-5\">\r\n            <p className=\"ml-2 text text_type_main-small\">{props.title}</p>\r\n            <div className=\"mt-5\"></div>\r\n            <p className=\"ml-2 text text_type_digits-medium\">{props.quantity}</p>\r\n        </div>\r\n\r\n    )\r\n}\r\nexport default OrdersReady","import React ,{useMemo} from \"react\";\r\nimport styles from \"./order-lists.module.css\";\r\nimport {TOrderLists} from \"../../../utils/types\";\r\nimport {splitArray} from \"../../../utils/utils\";\r\nconst OrderLists:React.FC<TOrderLists>=(props)=>{\r\n    \r\n    const readyOrders = useMemo(()=>{\r\n        return splitArray(props.ready,10);\r\n    },[props]);\r\n    return(\r\n        <div className={styles.main}>\r\n            <div className=\"mr-9\">\r\n            <p className=\"mb-6 ml-2 text text_type_main-medium\">:</p>\r\n            <div className={styles.number_container}>\r\n            {readyOrders && readyOrders.length > 0 && readyOrders.map((orders:number[], index:number ) => (\r\n\r\n                <div className=\"m-2\" key={index}>\r\n                    {orders.map((orderId:number, index2:number) => (\r\n                <p className={`text text_type_digits-small ${styles.green}`} key={index2} >{orderId}</p>\r\n                    ))\r\n                    }\r\n                  </div>\r\n                ))}\r\n            </div>\r\n            </div>\r\n            \r\n            <div>\r\n            <p className=\"mb-6 ml-2  text text_type_main-medium\" style={{ whiteSpace: 'nowrap' }}> :</p>\r\n            {props.waiting && props.waiting.map((orderId:number, index:number) => (\r\n                <div className=\"m-2\" key={index}>\r\n                <p className=\"text text_type_digits-small\" >{orderId}</p>\r\n                  </div>\r\n                ))}\r\n            \r\n            </div>\r\n        </div>\r\n\r\n    )\r\n}\r\nexport default OrderLists","import styles from \"./feed.module.css\";\r\nimport { useSelector, useDispatch } from \"../utils/hooks\";\r\nimport React from \"react\";\r\nimport OrdersReady from \"../components/orders-info/orders-ready/orders-ready\";\r\nimport OrderLists from \"../components/orders-info/order-lists/order-lists\";\r\nimport OrderCard from \"../components/orders-info/order-card/order-card\";\r\nimport { closeConnection, startConnection } from \"../services/actions/ws\";\r\nimport { TOrder } from \"../utils/types\";\r\n\r\nexport const FeedPage=()=>{\r\n  const { orders,total, totalToday } = useSelector(store=>store.ws);\r\n  const dispatch = useDispatch();\r\n  React.useEffect(()=>{\r\n\r\n     dispatch(startConnection(\"\"));\r\nreturn ()=>{ dispatch(closeConnection())}\r\n  },[dispatch])\r\n\r\n  var readyOrders = orders.filter(ord=>ord.status===\"done\").map(ord=> ord.number);\r\n  var waitingOrders = orders.filter(ord=>ord.status===\"pending\"||ord.status===\"created\").map(ord=> ord.number);\r\n  \r\nreturn(\r\n    <>\r\n     <main className={styles.main}>\r\n    \r\n          <section className={`pl-9 mr-15 ${styles.section}`}>\r\n          <p className=\"mt-10 mb-5 text text_type_main-large\"> </p>\r\n          <section className={styles.scrollable}>\r\n            {orders&& orders.map((order:TOrder, index:number)=>\r\n            <OrderCard {...order} key={index} ></OrderCard>\r\n            )}\r\n          </section>\r\n          </section>\r\n          <div className=\"ml-10\" />\r\n          <section className={`mt-20 ${styles.section}`}>\r\n          <OrderLists ready={readyOrders} waiting={waitingOrders}></OrderLists>\r\n    <OrdersReady title=\"   :\" quantity={total}></OrdersReady>\r\n    <OrdersReady title=\"  :\" quantity={totalToday}></OrdersReady>\r\n    \r\n          </section>\r\n    \r\n        \r\n      </main>\r\n    \r\n    </>\r\n);\r\n};","import {FC} from 'react';\r\nimport styles from './app-header.module.css';\r\ntype THeaderItemProps={\r\n    onClick:()=>void,\r\n    text:string\r\n}\r\nconst HeaderItem : FC<THeaderItemProps> =  (props)=>{     \r\n\r\n    return(<div className=\"pl-5 pr-5 pt-4\" onClick={props.onClick}>\r\n    <span className={styles.nav}>\r\n    {props.children}\r\n    <p className=\"ml-2 text text_type_main-default\">{props.text}</p>\r\n    </span>\r\n    </div>)\r\n}\r\nexport default HeaderItem","import React, { useCallback, useEffect } from \"react\";\r\nimport { Logo } from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nimport styles from \"./app-header.module.css\";\r\nimport HeaderItem from \"./app-header-item\";\r\nimport { useHistory, useLocation, Link } from \"react-router-dom\";\r\nimport {\r\n  BurgerIcon,\r\n  ListIcon,\r\n  ProfileIcon,\r\n} from \"@ya.praktikum/react-developer-burger-ui-components\";\r\nfunction AppHeader() {\r\n  const history = useHistory();\r\n  const [currentPage, setCurrentPage] = React.useState(\"\");\r\n  const location = useLocation();\r\n  useEffect(() => {\r\n    if (location.pathname.split(\"/\").length > 1)\r\n      setCurrentPage(location.pathname.split(\"/\")[1]);\r\n  }, [location]);\r\n  const setConstructor = useCallback(() => {\r\n    setCurrentPage(\"constructor\");\r\n    history.replace({ pathname: \"/\" });\r\n  }, [history]);\r\n  const setOrders = useCallback(() => {\r\n    setCurrentPage(\"feed\");\r\n    history.replace({ pathname: \"/feed\" });\r\n  }, [history]);\r\n  const setProfile = useCallback(() => {\r\n    setCurrentPage(\"profile\");\r\n    history.replace({ pathname: \"/profile\" });\r\n  }, [history]);\r\n\r\n  return (\r\n    <header>\r\n      <nav className=\" p-4 \">\r\n        <div className={styles.header}>\r\n          <div className={styles.header}>\r\n            <HeaderItem\r\n              text=\"\"\r\n              onClick={setConstructor}\r\n           \r\n            >\r\n              <BurgerIcon\r\n                type={\r\n                  !currentPage || currentPage === \"constructor\"\r\n                    ? \"primary\"\r\n                    : \"secondary\"\r\n                }\r\n              />\r\n            </HeaderItem>\r\n            <HeaderItem\r\n              text=\" \"\r\n              onClick={setOrders}\r\n           \r\n            >\r\n              <ListIcon\r\n                type={currentPage === \"feed\" ? \"primary\" : \"secondary\"}\r\n              />\r\n            </HeaderItem>\r\n          </div>\r\n          <Link to=\"/\" className={styles.logo}>\r\n            <Logo />\r\n          </Link>\r\n          <HeaderItem\r\n            text=\" \"\r\n            onClick={setProfile}\r\n           \r\n          >\r\n            <ProfileIcon\r\n              type={currentPage === \"profile\" ? \"primary\" : \"secondary\"}\r\n            />\r\n          </HeaderItem>\r\n        </div>\r\n      </nav>\r\n    </header>\r\n  );\r\n}\r\nexport default AppHeader;\r\n","import { ProtectedRoute } from \"../protected-route/protected-route\";\r\nimport Modal from \"../modal/modal\";\r\nimport {\r\n  ConstructorPage,\r\n  LoginPage,\r\n  Code404Page,\r\n  RegisterPage,\r\n  ForgotPasswordPage,\r\n  ResetPasswordPage,\r\n  ProfilePage,\r\n  IngredientDetailsPage,\r\n  OrderDetailsPage,\r\n  FeedPage\r\n} from \"../../pages\";\r\nimport { Route, Switch, useLocation, useHistory } from \"react-router-dom\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport AppHeader from \"../app-header/app-header\";\r\nimport { clearCurrentIngredient } from \"../../services/actions/ingredient-details\";\r\nimport { TLocationState } from \"../../utils/types\";\r\n\r\n\r\n\r\nconst ModalSwitch = () => {\r\n  const location = useLocation<TLocationState>();\r\n  const history = useHistory();\r\n  let background = location.state && location.state.background;\r\n  const dispatch = useDispatch();\r\n  const closeModal = () => {\r\n    dispatch( clearCurrentIngredient());\r\n\r\n    history.goBack();\r\n  };\r\n  return (\r\n    <>\r\n      <AppHeader />\r\n      <Switch location={background || location}>\r\n        <Route path=\"/\" exact={true}>\r\n          <ConstructorPage />\r\n        </Route>\r\n        <Route path=\"/constructor\" exact={true}>\r\n          <ConstructorPage />\r\n        </Route>\r\n        <Route path=\"/ingredient/:id\">\r\n          <IngredientDetailsPage />\r\n        </Route>\r\n        <Route path=\"/login\" exact={true}>\r\n          <LoginPage />\r\n        </Route>\r\n        <Route path=\"/register\" exact={true}>\r\n          <RegisterPage />\r\n        </Route>\r\n        <Route path=\"/forgot-password\" exact={true}>\r\n          <ForgotPasswordPage />\r\n        </Route>\r\n        <Route path=\"/reset-password\" exact={true}>\r\n          <ResetPasswordPage />\r\n        </Route>\r\n        <Route path=\"/feed/:id\" exact={true}>\r\n          <OrderDetailsPage />\r\n        </Route>\r\n        <Route path=\"/feed\" exact={true}>\r\n          <FeedPage />\r\n        </Route>\r\n        \r\n        <ProtectedRoute path=\"/profile\" exact={true}>\r\n          <ProfilePage />\r\n        </ProtectedRoute>\r\n        \r\n        <ProtectedRoute path=\"/exit\" exact={true}>\r\n          <ProfilePage />\r\n        </ProtectedRoute>\r\n        <ProtectedRoute path=\"/profile/orders\" exact={true}>\r\n          <ProfilePage />\r\n        </ProtectedRoute>\r\n        <ProtectedRoute path=\"/profile/orders/:id\" exact={true}>\r\n          <OrderDetailsPage />\r\n        </ProtectedRoute>\r\n\r\n        <Route>\r\n          <Code404Page />\r\n        </Route>\r\n      </Switch>\r\n      {background && (\r\n        <Route\r\n          path=\"/ingredient/:id\"\r\n          children={\r\n            <Modal onClose={closeModal} header=\" \">\r\n              <IngredientDetailsPage />\r\n            </Modal>\r\n          }\r\n        />\r\n        \r\n      )}\r\n      {background && (\r\n        <Route\r\n          path=\"/feed/:id\"\r\n          children={\r\n            <Modal onClose={closeModal} header=\" \">\r\n              <OrderDetailsPage />\r\n            </Modal>\r\n          }\r\n        />\r\n        \r\n      )}\r\n      {background && (\r\n        <Route\r\n          path=\"/profile/orders/:id\"\r\n          children={\r\n            <Modal onClose={closeModal} header=\" \">\r\n              <OrderDetailsPage />\r\n            </Modal>\r\n          }\r\n        />\r\n        \r\n      )}\r\n    </>\r\n  );\r\n};\r\nexport default ModalSwitch;\r\n","import React from \"react\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport { useSelector, useDispatch } from \"../../utils/hooks\";\nimport { getUser } from \"../../services/actions/profile\";\nimport { getIngredients } from \"../../services/actions/ingredients\";\nimport ModalSwitch from \"../modal-switch/modal-switch\";\nfunction App() {\n  const {\n    user,\n    profileRequest,\n    profileRequestFailed,\n    setProfileRequest,\n    regRequest,\n    forgotPassRequest,\n    resetPassRequest,\n  } = useSelector((store) => store.profile );\n  const dispatch = useDispatch();\n  React.useEffect(() => {\n    if (\n      !user &&\n      !profileRequest &&\n      !profileRequestFailed &&\n      !setProfileRequest &&\n      !regRequest &&\n      !forgotPassRequest &&\n      !resetPassRequest\n    )\n      dispatch(getUser());\n  }, [\n    dispatch,\n    user,\n    profileRequest,\n    profileRequestFailed,\n    setProfileRequest,\n    regRequest,\n    forgotPassRequest,\n    resetPassRequest,\n  ]);\n  React.useEffect(() => {\n    dispatch(getIngredients());\n  }, [dispatch]);\n\n  return (\n    <Router>\n      <ModalSwitch />\n    </Router>\n  );\n}\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import { TAddedIngredient } from \"../../utils/types\";\r\nimport {\r\n  ADD_INGREDIENT,\r\n  REMOVE_INGREDIENT,\r\n  MOVE_INGREDIENT,\r\n  CLEAR_INGREDIENTS,\r\n  TBurgerIngredientActions\r\n} from \"../actions/burger-constructor\";\r\nexport type TBurgerConstructorState={\r\n  burger : ReadonlyArray<TAddedIngredient>,\r\n  price : number\r\n}\r\nconst initialState:TBurgerConstructorState = {\r\n  burger: [],\r\n  price: 0,\r\n};\r\nexport const burgerConstructor = (state:TBurgerConstructorState = initialState, action:TBurgerIngredientActions):TBurgerConstructorState => {\r\n  switch (action.type) {\r\n    case CLEAR_INGREDIENTS:\r\n      return { ...initialState };\r\n    case ADD_INGREDIENT: //   ,       ,  \r\n      if (!action.item) return state;\r\n      let hasBun = state.burger\r\n        ? state.burger.filter((ingr) => ingr.type === \"top\").length > 0\r\n          ? 1\r\n          : 0\r\n        : 0;\r\n      let burgerIngredients = state.burger ? [...state.burger] : [];\r\n\r\n      if (action.item.type === \"bun\") {\r\n        //   \r\n        burgerIngredients.splice(0, hasBun, {\r\n          _id: action.item._id,\r\n          type: \"top\",\r\n          isLocked: true,\r\n          text: action.item.name + \"()\",\r\n          price: action.item.price,\r\n          thumbnail: action.item.image,\r\n          place: 0,\r\n        });\r\n        let placeOfBottomBun = burgerIngredients.length - hasBun;\r\n        burgerIngredients.splice(placeOfBottomBun, hasBun, {\r\n          _id: action.item._id,\r\n          type: \"bottom\",\r\n          isLocked: true,\r\n          text: action.item.name + \"()\",\r\n          price: action.item.price,\r\n          thumbnail: action.item.image,\r\n          place: placeOfBottomBun,\r\n        });\r\n      } else {\r\n        //    ,    ,     (  )    \r\n\r\n        let place = burgerIngredients.length - hasBun//     \r\n          \r\n        burgerIngredients.splice(place, 0, {\r\n          _id: action.item._id,\r\n          type: undefined,\r\n          isLocked: false,\r\n          text: action.item.name,\r\n          price: action.item.price,\r\n          thumbnail: action.item.image,\r\n          place: place,\r\n        });\r\n      }\r\n      let price =\r\n        burgerIngredients.length === 0\r\n          ? 0\r\n          : burgerIngredients\r\n              .map((ingr) => ingr.price)\r\n              .reduce((s, price) => s + price);\r\n      return { ...state, burger: burgerIngredients, price: price };\r\n    case REMOVE_INGREDIENT: //      ,  .       ,    \r\n      if (\r\n        !state.burger ||\r\n        action.place < 0 ||\r\n        action.place > state.burger.length - 1\r\n      )\r\n        return state;\r\n      let newburger = [...state.burger];\r\n      newburger.splice(action.place, 1);\r\n\r\n      let newprice =\r\n        newburger.length === 0\r\n          ? 0\r\n          : newburger.map((ingr) => ingr.price).reduce((s, price) => s + price);\r\n      newburger.forEach((ingr, index) => (ingr.place = index));\r\n      return {\r\n        burger: newburger,\r\n        price: newprice,\r\n      };\r\n    case MOVE_INGREDIENT: //  ,      .\r\n      if (!action.oldPlace || !action.newPlace) return { ...state };\r\n      if (\r\n        !state.burger ||\r\n        action.oldPlace < 1 ||\r\n        action.oldPlace > state.burger.length - 2\r\n      )\r\n        return { ...state };\r\n      let anewburger = [...state.burger];\r\n      let deleted = anewburger.splice(action.oldPlace, 1)[0];\r\n      anewburger.splice(action.newPlace, 0, deleted);\r\n      anewburger.forEach((ingr, index) => (ingr.place = index));\r\n      return {\r\n        ...state,\r\n        burger: anewburger,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { TIngredient } from \"../../utils/types\";\r\nimport {\r\n  GET_INGREDIENTS_REQUEST,\r\n  GET_INGREDIENTS_SUCCESS,\r\n  GET_INGREDIENTS_FAILED,\r\n  TIngredientActions\r\n} from \"../actions/ingredients\";\r\nexport type TIngredientsState={\r\n  ingredients:ReadonlyArray<TIngredient>,\r\n  ingredientsRequest:boolean,\r\n  ingredientsFailed:boolean\r\n}\r\nconst initialState:TIngredientsState = {\r\n  ingredients: [],\r\n  ingredientsRequest: false,\r\n  ingredientsFailed: false,\r\n};\r\nexport const ingredientsReducer = (state:TIngredientsState = initialState, action:TIngredientActions):TIngredientsState => {\r\n  switch (action.type) {\r\n    case GET_INGREDIENTS_REQUEST:\r\n      return { ...state, ingredientsRequest: true };\r\n    case GET_INGREDIENTS_SUCCESS:\r\n      return {\r\n        ...state,\r\n        ingredientsFailed: false,\r\n        ingredients: action.ingredients,\r\n        ingredientsRequest: false,\r\n      };\r\n    case GET_INGREDIENTS_FAILED:\r\n      return {\r\n        ...state,\r\n        ingredientsFailed: true,\r\n        ingredients: initialState.ingredients,\r\n        ingredientsRequest: false,\r\n      };\r\n    default: {\r\n      return state;\r\n    }\r\n  }\r\n};\r\n","import { SET_ERROR, CLEAR_ERROR, TErrorActions } from \"../actions/error\";\r\nexport type TErrorState = {\r\n  error:string\r\n}\r\nconst InitialState:TErrorState = {\r\n  error: \"\",\r\n};\r\nexport const errorReducer = (state:TErrorState = InitialState, action:TErrorActions):TErrorState => {\r\n  switch (action.type) {\r\n    case SET_ERROR:\r\n      return { ...state, error: action.error };\r\n    case CLEAR_ERROR:\r\n      return InitialState;\r\n    default:\r\n      return state ;\r\n  }\r\n};\r\n","import {\r\n  SUBMIT_ORDER_REQUEST,\r\n  SUBMIT_ORDER_SUCCESS,\r\n  SUBMIT_ORDER_FAILED,\r\n  RESET_ORDER,\r\n  GET_ORDER_REQUEST,\r\n  GET_ORDER_SUCCESS,\r\n  GET_ORDER_FAILED,\r\n  TOrderActions,\r\n} from \"../actions/order-details\";\r\nimport {TOrder} from \"../../utils/types\";\r\nexport type TOrderState = {\r\n  orderId: null|undefined|number,\r\n  submitOrderRequest: boolean,\r\n  submitOrderFailed: boolean,\r\n  getOrderRequest:boolean,\r\n  getOrderFailed:boolean,\r\n  order?:TOrder,\r\n};\r\nconst initialState:TOrderState = {\r\n  orderId: null,\r\n  submitOrderRequest: false,\r\n  submitOrderFailed: false,\r\n  getOrderRequest:false,\r\n  getOrderFailed:false,\r\n};\r\nexport const orderDetailsReducer = (state:TOrderState = initialState, action:TOrderActions):TOrderState => {\r\n  switch (action.type) {\r\n    case SUBMIT_ORDER_FAILED:\r\n      return {\r\n        ...initialState,\r\n        submitOrderFailed: true,\r\n      };\r\n    case SUBMIT_ORDER_REQUEST:\r\n      return {\r\n        ...initialState,\r\n        submitOrderRequest: true,\r\n      };\r\n    case SUBMIT_ORDER_SUCCESS:\r\n      return {\r\n        ...initialState,\r\n        orderId: action.order?.number,\r\n      };\r\n    case RESET_ORDER:\r\n      return { ...initialState };\r\n    case GET_ORDER_REQUEST:\r\n      return{\r\n        ...initialState,\r\n        getOrderRequest : true,\r\n      };\r\n    case GET_ORDER_FAILED:\r\n      return{\r\n        ...initialState,\r\n        getOrderFailed:true,\r\n      }\r\n    case GET_ORDER_SUCCESS:\r\n      return{\r\n        ...initialState,        \r\n        order:action.order,\r\n      }\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import {\r\n  SET_CURRENT_INGREDIENT,\r\n  CLEAR_CURRENT_INGREDIENT,\r\n  TCurrentIngredientActions\r\n} from \"../actions/ingredient-details\";\r\nexport type TCurrentIngredientState={\r\n  id:string|null|undefined\r\n}\r\nconst initialState:TCurrentIngredientState = {\r\n  id: null,\r\n};\r\nexport const ingredientDetailsReducer = (state:TCurrentIngredientState = initialState, action:TCurrentIngredientActions):TCurrentIngredientState => {\r\n  switch (action.type) {\r\n    case SET_CURRENT_INGREDIENT:\r\n      return { ...state, id: action.id };\r\n    case CLEAR_CURRENT_INGREDIENT:\r\n      return { ...initialState };\r\n    default:\r\n      return state ;\r\n  }\r\n};\r\n","import { TMenuTab } from \"../../utils/types\";\r\nimport { SET_TAB, SET_RATIO, TTabActions } from \"../actions/tab\";\r\n\r\nexport type TTabState = {\r\n  current: string,\r\n  tabs: ReadonlyArray<TMenuTab>\r\n};\r\nconst initialState:TTabState = {\r\n  current: \"bun\",\r\n  tabs: [\r\n    {\r\n      id: \"bun\",\r\n      title: \"\",\r\n      ratio: 0,\r\n    },\r\n    {\r\n      id: \"sauce\",\r\n      title: \"\",\r\n      ratio: 0,\r\n    },\r\n    {\r\n      id: \"main\",\r\n      title: \"\",\r\n      ratio: 0,\r\n    },\r\n  ],\r\n};\r\nexport const tabReducer = (state:TTabState = initialState, action:TTabActions):TTabState => {\r\n  switch (action.type) {\r\n    case SET_TAB:\r\n      return {\r\n        ...state,\r\n        current: action.current,\r\n        tabs: state.tabs.map((t) =>\r\n          t.id === action.current ? { ...t, ratio: 1.1 } : t\r\n        ),\r\n      };\r\n    case SET_RATIO:\r\n      let newTabs = state.tabs.map((t) =>\r\n        t.id === action.id ? { ...t, ratio: action.ratio } : t\r\n      );\r\n      let newCurrent = newTabs.reduce((prev, next) => {\r\n        return  prev.ratio < next.ratio ? next : prev;\r\n      }, newTabs[0]).id;\r\n      return {\r\n        ...state,\r\n        tabs: newTabs,\r\n        current: newCurrent,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import {\r\n  REG_USER_REQUEST,\r\n  REG_USER_SUCCESS,\r\n  REG_USER_FAILED,\r\n  GET_USER_REQUEST,\r\n  GET_USER_FAILED,\r\n  GET_USER_SUCCESS,\r\n  SET_USER_REQUEST,\r\n  SET_USER_FAILED,\r\n  SET_USER_SUCCESS,\r\n  FORGOT_PASS_REQUEST,\r\n  FORGOT_PASS_FAILED,\r\n  FORGOT_PASS_SUCCESS,\r\n  RESET_PASS_REQUEST,\r\n  RESET_PASS_FAILED,\r\n  RESET_PASS_SUCCESS,\r\n  TProfileActions\r\n} from \"../actions/profile\";\r\nimport { LOGIN_SUCCESS, LOGOUT_SUCCESS, TLoginActions } from \"../actions/login\";\r\nimport { TUser } from \"../../utils/types\";\r\nexport type TProfileState = {\r\n  user: null|undefined|TUser,\r\n  passwordResetRequired: boolean,\r\n  passwordReseted: boolean,\r\n  message: null|undefined|string,\r\n  profileRequest: boolean,\r\n  profileRequestFailed: boolean,\r\n  setProfileRequest: boolean,\r\n  setProfileRequestFailed: boolean,\r\n  regRequest: boolean,\r\n  regRequestFailed: boolean,\r\n  resetPassRequest: boolean,\r\n  resetPassRequestFailed: boolean,\r\n  forgotPassRequest: boolean,\r\n  forgotPassRequestFailed: boolean,\r\n};\r\nconst initialState:TProfileState = {\r\n  user: null,\r\n  passwordResetRequired: false,\r\n  passwordReseted: false,\r\n  message: \"\",\r\n  profileRequest: false,\r\n  profileRequestFailed: false,\r\n  setProfileRequest: false,\r\n  setProfileRequestFailed: false,\r\n  regRequest: false,\r\n  regRequestFailed: false,\r\n  resetPassRequest: false,\r\n  resetPassRequestFailed: false,\r\n  forgotPassRequest: false,\r\n  forgotPassRequestFailed: false,\r\n};\r\nexport const profileReducer = (state:TProfileState = initialState, action:TProfileActions|TLoginActions):TProfileState => {\r\n  switch (action.type) {\r\n    case LOGIN_SUCCESS:\r\n      return {\r\n        ...state,\r\n        user: {\r\n          name: action.user.name,\r\n          email: action.user.email,\r\n        },\r\n      };\r\n    case LOGOUT_SUCCESS:\r\n      return {\r\n        ...initialState,\r\n      };\r\n    case REG_USER_FAILED:\r\n      return {\r\n        ...initialState,\r\n        regRequestFailed: true,\r\n      };\r\n    case REG_USER_REQUEST:\r\n      return {\r\n        ...initialState,\r\n        regRequest: true,\r\n      };\r\n    case REG_USER_SUCCESS:\r\n      return {\r\n        ...initialState,\r\n        regRequest: false,\r\n        regRequestFailed: false,        \r\n        user: action.user?{\r\n          name: action.user?.name,\r\n          email: action.user?.email,\r\n        }:null,\r\n      };\r\n    case GET_USER_REQUEST:\r\n      return {\r\n        ...initialState,\r\n        profileRequest: true,\r\n      };\r\n    case GET_USER_SUCCESS:\r\n      return {\r\n        ...initialState,\r\n        user: action.user?{\r\n          name: action.user?.name,\r\n          email: action.user?.email,\r\n        }:null,\r\n        profileRequest: false,\r\n        profileRequestFailed: false,\r\n      };\r\n    case GET_USER_FAILED:\r\n      return {\r\n        ...initialState,\r\n        profileRequestFailed: true,\r\n      };\r\n    case SET_USER_FAILED:\r\n      return {\r\n        ...state,\r\n        setProfileRequestFailed: true,\r\n        setProfileRequest: false,\r\n      };\r\n    case SET_USER_REQUEST:\r\n      return {\r\n        ...state,\r\n        setProfileRequest: true,\r\n        setProfileRequestFailed: false,\r\n      };\r\n    case SET_USER_SUCCESS:\r\n      return {\r\n        ...initialState,\r\n        user: action.user?{\r\n          name: action.user?.name,\r\n          email: action.user?.email,\r\n        }:null,\r\n        setProfileRequest: false,\r\n        setProfileRequestFailed: false,\r\n      };\r\n    case FORGOT_PASS_REQUEST:\r\n      return {\r\n        ...state,\r\n        message: \"\",\r\n        passwordResetRequired: true,\r\n        profileRequest: true,\r\n        profileRequestFailed: false,\r\n      };\r\n    case FORGOT_PASS_FAILED:\r\n      return {\r\n        ...state,\r\n        message: action.message,\r\n        passwordResetRequired: false,\r\n        profileRequest: false,\r\n        profileRequestFailed: true,\r\n      };\r\n    case FORGOT_PASS_SUCCESS:\r\n      return {\r\n        ...state,\r\n        message: action.message,\r\n        passwordResetRequired: true,\r\n        profileRequest: false,\r\n        profileRequestFailed: false,\r\n      };\r\n    case RESET_PASS_REQUEST:\r\n      return {\r\n        ...state,\r\n        passwordResetRequired: true,\r\n        passwordReseted: false,\r\n        profileRequest: true,\r\n        profileRequestFailed: false,\r\n      };\r\n    case RESET_PASS_FAILED:\r\n      return {\r\n        ...state,\r\n        message: action.message,\r\n        passwordResetRequired: false,\r\n        passwordReseted: false,\r\n        profileRequest: false,\r\n        profileRequestFailed: true,\r\n      };\r\n    case RESET_PASS_SUCCESS:\r\n      return {\r\n        ...state,\r\n        message: action.message,\r\n        passwordResetRequired: false,\r\n        passwordReseted: true,\r\n        profileRequest: false,\r\n        profileRequestFailed: false,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import {\r\n  LOGIN_REQUEST,\r\n  LOGIN_SUCCESS,\r\n  LOGIN_FAILED,\r\n  LOGOUT_REQUEST,\r\n  LOGOUT_SUCCESS,\r\n  LOGOUT_FAILED,\r\n  TLoginActions\r\n} from \"../actions/login\";\r\nexport type TLoginState={\r\n  loginRequest: boolean,\r\n  loginRequestFailed: boolean,\r\n  logoutRequest: boolean,\r\n  logoutRequestFailed: boolean,\r\n  loggedIn?:boolean\r\n}\r\nconst initialState:TLoginState = {\r\n  loginRequest: false,\r\n  loginRequestFailed: false,\r\n  logoutRequest: false,\r\n  logoutRequestFailed: false,\r\n  loggedIn: false\r\n};\r\n\r\nexport const loginReducer = (state:TLoginState = initialState, action:TLoginActions):TLoginState => {\r\n  switch (action.type) {\r\n    case LOGIN_FAILED:\r\n      return {\r\n        ...initialState,\r\n        loginRequestFailed: true,\r\n      };\r\n    case LOGIN_REQUEST:\r\n      return {\r\n        ...initialState,\r\n        loginRequest: true,\r\n      };\r\n    case LOGIN_SUCCESS:\r\n      return {\r\n        ...initialState,\r\n        loggedIn: true,\r\n      };\r\n    case LOGOUT_REQUEST:\r\n      return {\r\n        ...initialState,\r\n        logoutRequest: true,\r\n      };\r\n    case LOGOUT_FAILED:\r\n      return {\r\n        ...state,\r\n        logoutRequestFailed: true,\r\n      };\r\n    case LOGOUT_SUCCESS:\r\n      return {\r\n        ...initialState,\r\n        loggedIn: false,\r\n      };\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import { TWSActions, \r\n    WS_CONNECTION_CLOSED, \r\n    WS_CONNECTION_ERROR,\r\n    WS_CONNECTION_START,\r\n    WS_CONNECTION_SUCCESS,\r\n    WS_CLOSE_CONNECTION, \r\n    WS_GET_MESSAGE \r\n    } from \"../actions/ws\";\r\n    import { TOrder } from \"../../utils/types\";\r\n    export type TWSState = {\r\n        orders: ReadonlyArray<TOrder>,\r\n        total: number,\r\n        totalToday: number,\r\n        isConnected:boolean,\r\n        errorText?:string\r\n      }\r\n    const initialState:TWSState = {\r\n        orders:[],\r\n        total:0,\r\n        totalToday:0,\r\n        isConnected:false,\r\n        errorText:\"\"\r\n    }\r\nexport const wSReducer = (state:TWSState = initialState, action:TWSActions):TWSState => {\r\n    switch (action.type) {\r\n        case WS_CONNECTION_START:\r\n            return {\r\n                ...initialState,\r\n            }\r\n        case WS_CONNECTION_ERROR:\r\n            return{\r\n                ...state,\r\n                errorText:action.payload?.timeStamp.toString()\r\n            }\r\n        case WS_CONNECTION_CLOSED:\r\n            return{\r\n                ...initialState,\r\n                isConnected: false\r\n            }\r\n        case WS_CONNECTION_SUCCESS:\r\n            return{\r\n                ...state,\r\n                isConnected:true,\r\n                errorText:\"\",\r\n            }\r\n        case WS_GET_MESSAGE:\r\n            return{\r\n                ...state,\r\n                orders: action.payload.orders,\r\n                total:action.payload.total,\r\n                totalToday:action.payload.totalToday\r\n            }  \r\n        case WS_CLOSE_CONNECTION:\r\n            return{\r\n                ...state\r\n            }      \r\n        default: return state;\r\n    }\r\n}\r\n","import { combineReducers } from \"redux\";\r\nimport { burgerConstructor } from \"./burger-constructor\";\r\nimport { ingredientsReducer } from \"./ingredients\";\r\nimport { errorReducer } from \"./error\";\r\nimport { orderDetailsReducer } from \"./order-details\";\r\nimport { ingredientDetailsReducer } from \"./ingredient-details\";\r\nimport { tabReducer } from \"./tab\";\r\nimport { profileReducer } from \"./profile\";\r\nimport { loginReducer } from \"./login\";\r\nimport { wSReducer } from \"./ws\";\r\nexport const rootReducer = combineReducers({\r\n  constructor: burgerConstructor,\r\n  ingredients: ingredientsReducer,\r\n  error: errorReducer,\r\n  order: orderDetailsReducer,\r\n  currentIngredient: ingredientDetailsReducer,\r\n  tab: tabReducer,\r\n  profile: profileReducer,\r\n  login: loginReducer,\r\n  ws:wSReducer\r\n});\r\n","import { createStore, applyMiddleware } from \"redux\";\r\nimport { composeWithDevTools } from 'redux-devtools-extension'\r\nimport thunk from \"redux-thunk\";\r\nimport { rootReducer } from \"./reducers\";\r\nimport {socketMiddleware} from \"./middleware\"\r\n\r\nconst enhancer = composeWithDevTools(applyMiddleware(thunk, socketMiddleware()));\r\n\r\nexport const store = createStore(rootReducer, enhancer);\r\n","import  { Middleware, MiddlewareAPI } from 'redux';\r\nimport  { AppDispatch, RootState } from \"../../utils/types\";\r\nimport  { WS_CONNECTION_START, connectionError, connectionStarted, getMessage, connectionClosed, WS_CLOSE_CONNECTION } from \"../actions/ws\";\r\nimport { TWSActions } from '../actions/ws';\r\n\r\nexport const socketMiddleware = (): Middleware => {\r\n    return ((store: MiddlewareAPI<AppDispatch, RootState>) => {\r\n        let socket: WebSocket | null = null;\r\n        return next => (action: TWSActions) => {\r\n            const { dispatch } = store;\r\n            const { type } = action;\r\n            if (type === WS_CONNECTION_START) {\r\n                socket = new WebSocket(action.payload);\r\n            }\r\n            if (socket) {\r\n                \r\n                if(type === WS_CLOSE_CONNECTION){\r\n                socket.close();   \r\n                }\r\n                socket.onopen = event => {\r\n                dispatch(connectionStarted());\r\n                };\r\n                socket.onerror = event => {\r\n                dispatch(connectionError(event));\r\n                };\r\n                socket.onmessage = event => {\r\n                const { data } = event;\r\n                dispatch(getMessage(data));\r\n                };\r\n                socket.onclose = event => {\r\n                dispatch(connectionClosed());\r\n                };\r\n\r\n            }\r\n            next(action);\r\n        };\r\n        }) as Middleware;\r\n}\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./components/app/app\";\nimport reportWebVitals from \"./reportWebVitals\";\nimport { Provider } from \"react-redux\";\nimport {store} from \"./services/store\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"profile-data_main__3nG0s\",\"item\":\"profile-data_item__3rWNy\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"details_part\":\"ingredient-details_details_part__hySgI\",\"details\":\"ingredient-details_details__35cHU\",\"details_card\":\"ingredient-details_details_card__36lXw\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"app-header_header__2zcNC\",\"logo\":\"app-header_logo__3AJql\",\"left\":\"app-header_left__3dZS5\",\"right\":\"app-header_right__3MOxo\",\"nav\":\"app-header_nav__1EXMX\",\"nav_item_right\":\"app-header_nav_item_right__Xr1Od\",\"nav_item_left\":\"app-header_nav_item_left__38NMr\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ingredient_card\":\"burger-ingredient-card_ingredient_card__2u_p3\",\"price_div\":\"burger-ingredient-card_price_div__7zu-r\",\"item_center\":\"burger-ingredient-card_item_center__1SZ_M\",\"img\":\"burger-ingredient-card_img__2a9VV\",\"link\":\"burger-ingredient-card_link__3DUyB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"reset-password_main__2UUlY\",\"inner\":\"reset-password_inner__13KKh\",\"item\":\"reset-password_item__ZML6Z\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"forgot-password_main__2HkJN\",\"inner\":\"forgot-password_inner__2RP7L\",\"item\":\"forgot-password_item__G1oIz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"ingredient-row_main__acLUi\",\"img_container\":\"ingredient-row_img_container__3lrUa\",\"item\":\"ingredient-row_item__2fUzL\",\"price_div\":\"ingredient-row_price_div__207ES\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"card\":\"order-card_card__1I3lq\",\"row\":\"order-card_row__jhw4f\",\"green\":\"order-card_green__3TIuM\",\"link\":\"order-card_link__2bg_w\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"price_div\":\"order-details-extended_price_div__CkJpO\",\"horizontal\":\"order-details-extended_horizontal__3SWR8\",\"main\":\"order-details-extended_main__3ZhSm\",\"green\":\"order-details-extended_green__1gW9b\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"item\":\"order-ingredients-list_item__3Qab6\",\"container\":\"order-ingredients-list_container__qN90G\",\"price_div\":\"order-ingredients-list_price_div__3u3cM\",\"scrollable\":\"order-ingredients-list_scrollable__3IzTz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"feed_main__1MEbm\",\"section\":\"feed_section__38jAE\",\"scrollable\":\"feed_scrollable__1we-8\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"constructor_main__eymxx\",\"section\":\"constructor_section__1-hjf\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"page404_main__1Quz9\",\"section\":\"page404_section__2vo_l\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"order-details_main__x__0q\",\"section\":\"order-details_section__39Qou\",\"window\":\"order-details_window__1FzcZ\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"order-lists_main__1mqMU\",\"number_container\":\"order-lists_number_container__1_bSK\",\"green\":\"order-lists_green__1knCf\",\"no_wrap\":\"order-lists_no_wrap__1yEED\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"modal\":\"modal_modal__27Xl8\",\"header\":\"modal_header__1mi-K\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"burger\":\"burger-constructor_burger__dcbuK\",\"scrollable\":\"burger-constructor_scrollable__3WQde\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"awaiter_main__2sm6q\",\"inner\":\"awaiter_inner__1MKse\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"ingredient-details_main__2fbBN\",\"section\":\"ingredient-details_section__3pqDP\"};"],"sourceRoot":""}